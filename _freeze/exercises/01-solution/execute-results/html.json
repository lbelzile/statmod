{
  "hash": "ec01f86cce15211977ed42647b3d7a53",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Statistical inference\"\nexecute:\n  echo: true\n  eval: true\n  message: false\n  warning: false\n  error: false\n---\n\n\n\n## Solution to Exercise 1.1\n\n\n1. The level of the test is 5%, so we should reject 5% of the time under the null.\n2. The curve is the power curve, i.e., the percentage of rejection of the null hypothesis for one-sample $t$-test. The further away from the true value $\\mu$, the higher the ability to detect departures from $\\mathscr{H}_0$. Because we set $\\alpha=0.05$, the curve should be around 0.05 near $\\mu$ and increase towards 1 as we move away from the true population mean.\n3. Power increases if the sample size $n$ increases, so we expect to see the curve be higher everywhere, but at $\\mu$ where it should be close to $0.05$ if the test is calibrated.\n4. The data are clearly not symmetric and heavily discretized, yet the power curve of the one-sample $t$-test is steadily increasing and the nominal level matches the type I error. This illustrates the robustness of the test to departures from normality.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(renfe, package = \"hecstatmod\")\nlibrary(ggplot2)\nrenfe_sub <- renfe |> \n         dplyr::filter(type == \"AVE\")\nparams <- as.list(MASS::fitdistr(renfe_sub$duration, \"normal\")$estimate)\nggplot(data = renfe_sub,\n       mapping = aes(sample = duration)) +\n  geom_qq(dparams = list(mean = params$mean, \n                         sd = params$sd)) +\n  geom_abline(intercept = 0, slope = 1) + \n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](01-solution_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n\n\n## Solution to Exercise 1.2\n\n\n1. The empirical coverage is 0.947. The coverage is not far from nominal coverage of 0.95, indicating the test is well calibrated.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(renfe_simu, package = \"hecstatmod\")\ntrue_diff <- -0.28\ncoverage <- mean(with(renfe_simu, cilb < true_diff & ciub > true_diff))\ncoverage\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.947\n```\n\n\n:::\n:::\n\n\n\n2. The histogram for the mean difference in @fig-renfe-hist looks symmetric and light-tailed, and centered around 0.28, whereas the $p$-values are scattered in the unit interval, with some values closer to zero.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(patchwork) \ntheme_set(theme_classic())\ng1 <- ggplot(data = renfe_simu, \n             mapping = aes(x = meandif)) +\n  geom_density() +\n  geom_vline(xintercept = true_diff, \n             color = \"gray\",\n             linetype = \"dashed\") +\n  labs(x = \"mean difference\")\ng2 <- ggplot(data = renfe_simu,\n             mapping = aes(x = pval)) +\n  geom_histogram(bins = 11)\ng1 + g2\n```\n\n::: {.cell-output-display}\n![Left: density plot of the mean difference price for high-speed train tickets from Madrid to Barcelona versus Barcelona to Madrid, along with average (gray vertical line). Right: histogram of p-values.](01-solution_files/figure-html/fig-renfe-hist-1.png){#fig-renfe-hist width=672}\n:::\n:::\n\n\n\n3. The power is $0.105$. Under the alternative regime (since $\\Delta=0.28$€), we only reject 10.5\\% of the time. While this number is low, it is due to the small size of the true mean difference, which is hard to detect unless the sample size is enormous. The estimated mean difference for the sample is $0.274$€.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(price ~ dest, data = renfe_sub)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  price by dest\nt = -1.9433, df = 9170.2, p-value = 0.05201\nalternative hypothesis: true difference in means between group Barcelona-Madrid and group Madrid-Barcelona is not equal to 0\n95 percent confidence interval:\n -1.652691253  0.007157275\nsample estimates:\nmean in group Barcelona-Madrid mean in group Madrid-Barcelona \n                      87.40053                       88.22329 \n```\n\n\n:::\n\n```{.r .cell-code}\nmean(renfe_simu$pval < 0.05)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.105\n```\n\n\n:::\n:::\n\n\n\n\n## Solution to Exercise 1.3\n\nCareful here, as the price of the `REXPRESS` tickets is fixed at 43.25€. The only random sample is for the other class of train!\n \n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(renfe,\n     t.test(x = price,\n            mu = 43.25,\n            conf.level = 0.9,\n            subset = type == \"AVE-TGV\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne Sample t-test\n\ndata:  price\nt = 197.9, df = 9999, p-value < 2.2e-16\nalternative hypothesis: true mean is not equal to 43.25\n90 percent confidence interval:\n 85.73892 86.45119\nsample estimates:\nmean of x \n 86.09505 \n```\n\n\n:::\n:::\n\n\n \n- The null hypothesis is $\\mathscr{H}_0: \\mu_{\\text{AVE-TGV}}=43.25$€ against the alternative $\\mathscr{H}_1: \\mu_{\\text{AVE-TGV}}\\neq 43.25$€, where $\\mu_{\\text{AVE-TGV}}$ is the average `AVE-TGV` ticket price.\n- Since this is a one-sample location problem, we use a one-sample $t$-test.\n- The estimated mean difference is $45.63$€$= 88.88$€$-43.25$€, with 90\\% confidence interval for the mean difference of $[44.14, 47.12]$.\n- The $t$-statistic is 50.519 with 428 degrees of freedom, and the $p$-value is negligible.\n- We strongly reject the null hypothesis that high-speed trains are the same price as RegioExpress ones.\n\n",
    "supporting": [
      "01-solution_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}