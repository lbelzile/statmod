<!DOCTYPE html>
<html lang="en"><head>
<script src="MATH60604A-slides5a_files/libs/clipboard/clipboard.min.js"></script>
<script src="MATH60604A-slides5a_files/libs/quarto-html/tabby.min.js"></script>
<script src="MATH60604A-slides5a_files/libs/quarto-html/popper.min.js"></script>
<script src="MATH60604A-slides5a_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="MATH60604A-slides5a_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="MATH60604A-slides5a_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="MATH60604A-slides5a_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="MATH60604A-slides5a_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.56">

  <meta name="author" content="Léo Belzile, HEC Montréal">
  <meta name="dcterms.date" content="2024-01-01">
  <title>Statistical modelling</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="MATH60604A-slides5a_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="MATH60604A-slides5a_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="MATH60604A-slides5a_files/libs/revealjs/dist/theme/quarto.css">
  <link href="MATH60604A-slides5a_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="MATH60604A-slides5a_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="MATH60604A-slides5a_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="MATH60604A-slides5a_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="MATH60604A-slides5a_files/libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="MATH60604A-slides5a_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#002855" class="quarto-title-block center">
  <h1 class="title">Statistical modelling</h1>
  <p class="subtitle">05. Linear models</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Léo Belzile, HEC Montréal 
</div>
</div>
</div>

  <p class="date">2024</p>
</section>
<section id="interaction" class="slide level2">
<h2>Interaction</h2>
<p>An interaction occurs if some explanatory variables, when coupled together, have different impacts than the superposition of each.</p>
<p>If <span class="math inline">\(X_j\)</span> and <span class="math inline">\(X_k\)</span> interact, the marginal effect of <span class="math inline">\(\mathsf{E}(Y \mid \boldsymbol{X})\)</span> with respect to <span class="math inline">\(X_j\)</span> is a function of <span class="math inline">\(X_k\)</span> or vice-versa.</p>
<p>We will restrict attention to the cases where one or more of the explanatories is a categorical variable (factor).</p>
</section>
<section id="insurance-premium" class="slide level2">
<h2>Insurance premium</h2>
<p>Smokers who have a BMI of 30 and above pay a hefty premium, but there is also seemingly a linear increase in the amount charged with BMI. We see no such behaviour for non-smokers.</p>

<img data-src="MATH60604A-slides5a_files/figure-revealjs/fig-insuranceinter1-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><p class="caption">
Figure&nbsp;1: Graph of <code>insurance</code> charges against body mass index, colored by smoking status.
</p></section>
<section id="toy-example-1-continuous-vs-categorical" class="slide level2">
<h2>Toy example 1 – continuous vs categorical</h2>
<p>We consider a toy model for the <code>interaction</code> data. The base model, without interaction, is <span class="math display">\[\begin{align*}
\texttt{intention}=\beta_0 + \beta_1 \texttt{sex} + \beta_2 \texttt{fixation} + \varepsilon,
\end{align*}\]</span> where <span class="math inline">\(\texttt{sex=1}\)</span> for women and <span class="math inline">\(\texttt{sex=0}\)</span> for men.</p>
<p>The effect of fixation in this model is the same regardless of sex.</p>
<p>In order to add a different slope for men and women, we can create a new variable equal to the product <span class="math inline">\(\texttt{fixation}\times\texttt{sex}\)</span> and add it to the model, <span class="math display">\[\begin{align*}
\mathsf{E}(\texttt{intention} \mid \cdot)= \beta_0 + \beta_1 \texttt{sex} + \beta_2\texttt{fixation}  + \beta_3 \texttt{fixation}\cdot \texttt{sex}.
\end{align*}\]</span></p>
</section>
<section id="is-there-an-interaction" class="slide level2">
<h2>Is there an interaction?</h2>

<img data-src="MATH60604A-slides5a_files/figure-revealjs/fig-interaction-slope-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">
Figure&nbsp;2: Scatterplots and fitted lines for a model with a single continuous and binary explanatory, without (left) and with (right) an interaction term.
</p></section>
<section id="parameter-interpretation" class="slide level2">
<h2>Parameter interpretation</h2>
<p>Depending on the value of the binary variable <span class="math inline">\(\texttt{sex}\)</span>, we get <span class="math display">\[\begin{align*}
\mathsf{E}(\texttt{intention} \mid \cdot) =
\begin{cases}
(\beta_0 + \beta_1) + (\beta_2 + \beta_3)\texttt{fixation}, &amp; \texttt{sex}=1 \text{ (women)},\\
  \beta_0 + \beta_2 \texttt{fixation}, &amp; \texttt{sex}=0 \text{ (men)}.
\end{cases}
\end{align*}\]</span> The interpretation of the coefficients in the model is as usual with the treatment contrast parametrization:</p>
<ul>
<li><span class="math inline">\(\beta_0\)</span> is the average buying intention when the fixation time is zero for men,</li>
<li><span class="math inline">\(\beta_1\)</span> is the difference in intercept for women vs men,</li>
<li><span class="math inline">\(\beta_2\)</span> is the unit increase in intention to buy per second of fixation for men,</li>
<li><span class="math inline">\(\beta_3\)</span> is the difference in slope for women vs men.</li>
</ul>
</section>
<section id="testing-for-an-interaction" class="slide level2">
<h2>Testing for an interaction</h2>
<p>Testing whether the interaction is significant boils down to using the test <span class="math inline">\(\mathscr{H}_0: \beta_3=0\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="fu">data</span>(interaction, <span class="at">package =</span> <span class="st">"hecstatmod"</span>)</span>
<span id="cb1-2"><a href=""></a><span class="co"># To specify an interaction use :</span></span>
<span id="cb1-3"><a href=""></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(intention <span class="sc">~</span> sex <span class="sc">+</span> fixation <span class="sc">+</span>  sex<span class="sc">:</span>fixation, </span>
<span id="cb1-4"><a href=""></a>          <span class="at">data =</span> interaction)</span>
<span id="cb1-5"><a href=""></a><span class="co"># A shortcut is sex*fixation, which expands to the above</span></span>
<span id="cb1-6"><a href=""></a><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients</span>
<span id="cb1-7"><a href=""></a><span class="do">##              Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb1-8"><a href=""></a><span class="do">## (Intercept)       2.7       0.28     9.7  1.0e-16</span></span>
<span id="cb1-9"><a href=""></a><span class="do">## sex               1.3       0.38     3.5  7.7e-04</span></span>
<span id="cb1-10"><a href=""></a><span class="do">## fixation          0.5       0.15     3.3  1.3e-03</span></span>
<span id="cb1-11"><a href=""></a><span class="do">## sex:fixation      2.1       0.20    10.7  5.6e-19</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The model with the interaction is significantly better, meaning that the effect of fixation time on intention to buy varies according to sex.</p>
</section>
<section id="marginality-principle" class="slide level2">
<h2>Marginality principle</h2>
<p>All lower interaction terms should be included if an interaction is present.</p>
<p>For example, we would <strong>not</strong> remove <span class="math inline">\(\texttt{fixation}\)</span> while keeping the interaction term <span class="math inline">\(\texttt{fixation*sex}\)</span>, even if we fail to reject <span class="math inline">\(\mathscr{H}_0:\beta_2=0\)</span> because otherwise <span class="math display">\[\begin{align*}
&amp;\mathsf{E}(\texttt{intention} \mid \cdot) =
\begin{cases}
(\beta_0 + \beta_1) + \beta_3\texttt{fixation}, &amp; \texttt{sex}=1 \text{ (women)},\\
  \beta_0, &amp;\texttt{sex}=0 \text{ (men)};                 
\end{cases}
\end{align*}\]</span><br>
this implies that intention to buy is constant for men, regardless of the fixation time.</p>
<p>As the choice of baseline is arbitrary, changing the dummy (<span class="math inline">\(\texttt{0}\)</span> for women, <span class="math inline">\(\texttt{1}\)</span> for men), would yield a different model and so potentially different inferences.</p>
</section>
<section id="example-2---categorical-vs-categorical" class="slide level2">
<h2>Example 2 - categorical vs categorical</h2>
<p>Consider a linear model with factors <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> and their interactions.</p>
<p>This is a <strong>two-way ANOVA model</strong>, in which each subgroup <span class="math inline">\((a_i, b_j)\)</span> has a different mean <span class="math inline">\(\mu_{ij}\)</span>.</p>
<p>e.g., if <span class="math inline">\(A\)</span> has <span class="math inline">\(n_a=3\)</span> levels and <span class="math inline">\(B\)</span> has <span class="math inline">\(n_b=2\)</span> levels.</p>
<table class="caption-top">
<thead>
<tr class="header">
<th><span class="math inline">\(\qquad B\)</span><br> <span class="math inline">\(A\)</span> <span class="math inline">\(\qquad\)</span></th>
<th style="text-align: center;"><span class="math inline">\(b_1\)</span></th>
<th style="text-align: center;"><span class="math inline">\(b_2\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\text{row mean}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(a_1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mu_{11}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mu_{12}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mu_{1.}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(a_2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mu_{21}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mu_{22}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mu_{2.}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(a_3\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mu_{31}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mu_{32}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mu_{3.}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\text{column mean}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mu_{.1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mu_{.2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mu\)</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Row, column and overall averages are <strong>equiweighted</strong> combinations of the cell means <span class="math inline">\(\mu_{ij}\)</span>.</li>
<li>Sample estimates are obtained by replacing <span class="math inline">\(\mu_{ij}\)</span> by subgroup sample means.</li>
</ul>
</section>
<section id="interaction-plot" class="slide level2">
<h2>Interaction plot</h2>
<p>Plot the averages (with confidence intervals) as a function of the explanatories.</p>
<p>If lines are parallel, then there is no interaction.</p>

<img data-src="MATH60604A-slides5a_files/figure-revealjs/fig-2by2-interaction-plot-1.png" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption">
Figure&nbsp;3: Interaction plots for 2 by 2 designs. Illustration adapted from Figure 10.2 of Crump, Navarro and Suzuki (2019) by Matthew Crump (CC BY-SA 4.0 license)
</p></section>
<section id="cell-means-for-2-by-2-designs" class="slide level2">
<h2>Cell means for 2 by 2 designs</h2>

<img data-src="MATH60604A-slides5a_files/figure-revealjs/tbl-2by2-interaction-1.png" style="width:70.0%" class="r-stretch quarto-figure-center"><p class="caption">
Table&nbsp;1: Patterns for means for each of the possible kinds of general outcomes in a 2 by 2 design.
</p></section>
<section id="example-1-loans-versus-credit" class="slide level2">
<h2>Example 1 : loans versus credit</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Supplementary study 5 of <span class="citation" data-cites="Sharma.Tully.Cryder:2021">Sharma, Tully, and Cryder (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span> consists of a <span class="math inline">\(2 \times 2\)</span> between-subject (i.e., no repeated measure per individual) ANOVA with factors</p>
<ul>
<li>debt type (<code>debttype</code>), either “loan” or “credit”</li>
<li><code>purchase</code> type, either <code>discretionary</code> or not (<code>need</code>)</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="MATH60604A-slides5a_files/figure-revealjs/unnamed-chunk-7-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>No evidence of interaction.</p>
</div></div>
</section>
<section id="example-2---cultural-appropriation" class="slide level2">
<h2>Example 2 - cultural appropriation</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Study 4 of <span class="citation" data-cites="Lin.Kim.Uduehi.Keinan:2024">Lin et al. (<a href="#/references" role="doc-biblioref" onclick="">2024</a>)</span> uses a <span class="math inline">\(3 \times 2 \times 2\)</span> between-subject ANOVA focused on cultural appropriation for a soul food recipe cookbook from Chef Dax with factors</p>
<ul>
<li><code>chefdax</code>: ethnicity, either <code>black</code> or <code>not black</code></li>
<li><code>politideo</code>: political ideology, either <code>conservative</code> or <code>liberal</code></li>
<li><code>brandaction</code>: how recipes were obtained by Chef Dax, either peeking, with permission or no mention (control).</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="MATH60604A-slides5a_files/figure-revealjs/unnamed-chunk-8-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Interaction between <code>chefdax</code> (ethnicity) and <code>ideology</code>.</p>
</div></div>
</section>
<section id="analysis-of-variance-table" class="slide level2">
<h2>Analysis of variance table</h2>
<p>The analysis of variance table compares models with (or without) <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(AB\)</span>.</p>
<p>If the sample is <strong>balanced</strong> (same number of observations per subgroup), we can uniquely decompose the variance as</p>
<p><span class="math display">\[\underset{\text{total}}{\mathsf{SS}_{c}} = \underset{\text{factor $A$}}{\mathsf{SS}_A} + \underset{\text{factor $B$}}{\mathsf{SS}_B} + \underset{\text{interaction}}{\mathsf{SS}_{AB}} + \underset{\text{residual}}{\mathsf{SS}_e}\]</span></p>
<ul>
<li>a model without <span class="math inline">\(AB\)</span> would have residual sum of squares of <span class="math inline">\(\mathsf{SS}_{AB} + \mathsf{SS}_e\)</span>, but <span class="math inline">\((n_a-1)(n_b-1)\)</span> fewer parameters.</li>
<li>a model without <span class="math inline">\(A\)</span> (i.e., only factor <span class="math inline">\(B\)</span>) would have <span class="math inline">\(n_a-1\)</span> fewer parameter, and residual sum of squares of <span class="math inline">\(\mathsf{SS}_{A} + \mathsf{SS}_{AB} + \mathsf{SS}_e\)</span>, versus <span class="math inline">\(\mathsf{SS}_{AB} + \mathsf{SS}_e\)</span> for the alternative.</li>
<li>the difference in sum of squares is <span class="math inline">\(\mathsf{SS}_A\)</span> for <span class="math inline">\(A\)</span>, <span class="math inline">\(\mathsf{SS}_{AB}\)</span> for the interaction <span class="math inline">\(A \times B\)</span>, etc.</li>
</ul>
</section>
<section id="test-statistic-for-anova" class="slide level2">
<h2>Test statistic for ANOVA</h2>
<p>If the alternative model has <span class="math inline">\(n_an_b\)</span> parameters for the mean, and we impose <span class="math inline">\(n_a-1\)</span> linear restrictions under the null hypothesis to the model estimated based on <span class="math inline">\(n\)</span> independent observations, the test statistic is</p>
<p><span class="math display">\[\begin{align*}
F = \frac{\mathsf{SS}_A/(n_a-1)}{\mathsf{SS}_{e}/ (n-n_an_b)}
\end{align*}\]</span></p>
<ul>
<li>The numerator is the difference in sum of squares, denoted <span class="math inline">\(\mathsf{SS}_A\)</span>, from models fitted under <span class="math inline">\(\mathscr{H}_0\)</span> and <span class="math inline">\(\mathscr{H}_a\)</span>, divided by degrees of freedom <span class="math inline">\(n_a-1\)</span> (number of additional parameters).</li>
<li>The denominator is an estimator of the variance (termed mean squared error of residuals).</li>
</ul>
</section>
<section id="analysis-of-variance-table-1" class="slide level2">
<h2>Analysis of variance table</h2>
<table class="caption-top">
<colgroup>
<col style="width: 21%">
<col style="width: 28%">
<col style="width: 21%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th>term</th>
<th>degrees of freedom</th>
<th>mean square</th>
<th><span class="math inline">\(F\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(A\)</span></td>
<td><span class="math inline">\(n_a-1\)</span></td>
<td><span class="math inline">\(\mathsf{MS}_{A}=\mathsf{SS}_A/(n_a-1)\)</span></td>
<td><span class="math inline">\(\mathsf{MS}_{A}/\mathsf{MS}_{\text{res}}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(B\)</span></td>
<td><span class="math inline">\(n_b-1\)</span></td>
<td><span class="math inline">\(\mathsf{MS}_{B}=\mathsf{SS}_B/(n_b-1)\)</span></td>
<td><span class="math inline">\(\mathsf{MS}_{B}/\mathsf{MS}_{\text{res}}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(AB\)</span></td>
<td><span class="math inline">\((n_a-1)(n_b-1)\)</span></td>
<td><span class="math inline">\(\mathsf{MS}_{AB}=\mathsf{SS}_{AB}/\{(n_a-1)(n_b-1)\}\)</span></td>
<td><span class="math inline">\(\mathsf{MS}_{AB}/\mathsf{MS}_{\text{res}}\)</span></td>
</tr>
<tr class="even">
<td>residuals</td>
<td><span class="math inline">\(n-n_an_b\)</span></td>
<td><span class="math inline">\(\mathsf{MS}_{\text{res}}=\mathsf{SS}_{e}/ (n-ab)\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td>total</td>
<td><span class="math inline">\(n-1\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="comparing-nested-models-with-unbalanced-data" class="slide level2">
<h2>Comparing nested models with unbalanced data</h2>
<p>We are comparing nested models, but depending on the decomposition, these are different models!</p>
<div class="cell">
<div id="tbl-ssdecompo" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ssdecompo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Sum of square decompositions in ANOVA tables. Comparison of sum of squares between null, versus alternative model.
</figcaption>
<div aria-describedby="tbl-ssdecompo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top">
<colgroup>
<col style="width: 20%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">type 1</th>
<th style="text-align: left;">type II</th>
<th style="text-align: left;">type III</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\boldsymbol{A}\)</span></td>
<td style="text-align: left;">intercept vs <span class="math inline">\(A\)</span></td>
<td style="text-align: left;"><span class="math inline">\(B\)</span> vs <span class="math inline">\((A,B)\)</span></td>
<td style="text-align: left;"><span class="math inline">\((B, AB)\)</span> vs <span class="math inline">\((A,B, AB)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\boldsymbol{B}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(A\)</span> vs <span class="math inline">\((A,B)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(A\)</span> vs <span class="math inline">\((A,B)\)</span></td>
<td style="text-align: left;"><span class="math inline">\((A, AB)\)</span> vs <span class="math inline">\((A,B,AB)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\boldsymbol{AB}\)</span></td>
<td style="text-align: left;"><span class="math inline">\((A,B)\)</span> vs <span class="math inline">\((A,B,AB)\)</span></td>
<td style="text-align: left;"><span class="math inline">\((A,B)\)</span> vs <span class="math inline">\((A,B,AB)\)</span></td>
<td style="text-align: left;"><span class="math inline">\((A,B)\)</span> vs <span class="math inline">\((A,B,AB)\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p><em>Read the table backward (starting with the interaction).</em></p>
<p>Use the type II sum of square by default (default with <code>car::Anova</code>). Type I decomposition (<code>anova</code>) is sequential, while type III does not respect marginality principles.</p>
</section>
<section id="example-1---perception-of-debt" class="slide level2">
<h2>Example 1 - perception of debt</h2>
<p><span class="citation" data-cites="Sharma.Tully.Cryder:2021">Sharma, Tully, and Cryder (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span> conducted a 2 by 2 between-subjects comparison (two-way ANOVA) varying</p>
<ul>
<li>the type of debt (whether the money was advertised as <code>credit</code> or <code>loan</code>) and</li>
<li>the type of purchase the latter would be used for (<code>discretionary</code> spending or <code>need</code> for necessary purchases).</li>
</ul>
<p>The response is the average of the likelihood and interest in the product, both measured using a 9 point Likert scale from 1 to 9.</p>
<p>The mean model with an interaction can be written using the treatment contrast parametrization as <span class="math display">\[\begin{align*}
\texttt{likelihood} &amp;= \beta_0 + \beta_1\mathbf{1}_{\texttt{purchase=need}} + \beta_2\mathbf{1}_{\texttt{debttype=loan}} \\&amp;\quad+ \beta_3\mathbf{1}_{\texttt{purchase=need}}\mathbf{1}_{\texttt{debttype=loan}} + \varepsilon
\end{align*}\]</span></p>
</section>
<section id="additive-model" class="slide level2">
<h2>Additive model</h2>
<p>The <strong>additive</strong> model with the treatment contrast parametrization has <span class="math inline">\(1 + (n_a-1) + (n_b-1)\)</span> parameters, with <span class="math display">\[\mathsf{E}(Y \mid A=a_i, B=b_j) = \mu+ \alpha_i + \beta_j.\]</span> We need a suitable constraint on <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, e.g., <span class="math inline">\(\alpha_1=0\)</span> (treatment contrast) or <span class="math inline">\(\sum_{i=1}^{n_a}\alpha_i=0\)</span> (sum-to-zero constraint).</p>
<p>The last line of the ANOVA table with the <span class="math inline">\(F\)</span>-statistics gives the <span class="math inline">\(p\)</span>-value for the test comparing the model with and without the interaction term.</p>
</section>
<section id="fitting-anova-and-extracting-group-means" class="slide level2">
<h2>Fitting ANOVA and extracting group means</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="co"># Analysing Supplementary Study 5</span></span>
<span id="cb2-2"><a href=""></a><span class="co"># of Sharma, Tully, and Cryder (2021)</span></span>
<span id="cb2-3"><a href=""></a><span class="fu">data</span>(STC21_SS5, <span class="at">package =</span> <span class="st">"hecedsm"</span>)</span>
<span id="cb2-4"><a href=""></a><span class="co"># Use 'aov' to fit models to balanced data, with categorical variables</span></span>
<span id="cb2-5"><a href=""></a><span class="co"># Equivalent to 'lm' with sum-to-zero contrasts</span></span>
<span id="cb2-6"><a href=""></a>mod <span class="ot">&lt;-</span> <span class="fu">aov</span>(likelihood <span class="sc">~</span> purchase<span class="sc">*</span>debttype, </span>
<span id="cb2-7"><a href=""></a>           <span class="at">data =</span> STC21_SS5)</span>
<span id="cb2-8"><a href=""></a><span class="co"># Check counts per subcategory (data are unbalanced)</span></span>
<span id="cb2-9"><a href=""></a><span class="fu">xtabs</span>(<span class="sc">~</span>purchase <span class="sc">+</span> debttype, <span class="at">data =</span> STC21_SS5)</span>
<span id="cb2-10"><a href=""></a><span class="do">##                debttype</span></span>
<span id="cb2-11"><a href=""></a><span class="do">## purchase        credit loan</span></span>
<span id="cb2-12"><a href=""></a><span class="do">##   discretionary    392  359</span></span>
<span id="cb2-13"><a href=""></a><span class="do">##   need             361  389</span></span>
<span id="cb2-14"><a href=""></a><span class="co"># Compute overall/rows/columns/cells means</span></span>
<span id="cb2-15"><a href=""></a>means <span class="ot">&lt;-</span> <span class="fu">model.tables</span>(mod, <span class="at">type =</span> <span class="st">"means"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="comparing-models" class="slide level2">
<h2>Comparing models</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="co"># Analysis of variance reveals  non-significant</span></span>
<span id="cb3-2"><a href=""></a><span class="co"># interaction of purchase and type</span></span>
<span id="cb3-3"><a href=""></a>car<span class="sc">::</span><span class="fu">Anova</span>(mod, <span class="at">type =</span> <span class="dv">2</span>)</span>
<span id="cb3-4"><a href=""></a><span class="do">## Anova Table (Type II tests)</span></span>
<span id="cb3-5"><a href=""></a><span class="do">## </span></span>
<span id="cb3-6"><a href=""></a><span class="do">## Response: likelihood</span></span>
<span id="cb3-7"><a href=""></a><span class="do">##                   Sum Sq   Df F value  Pr(&gt;F)    </span></span>
<span id="cb3-8"><a href=""></a><span class="do">## purchase             752    1   98.21 &lt; 2e-16 ***</span></span>
<span id="cb3-9"><a href=""></a><span class="do">## debttype              92    1   12.04 0.00054 ***</span></span>
<span id="cb3-10"><a href=""></a><span class="do">## purchase:debttype     14    1    1.79 0.18171    </span></span>
<span id="cb3-11"><a href=""></a><span class="do">## Residuals          11467 1497                    </span></span>
<span id="cb3-12"><a href=""></a><span class="do">## ---</span></span>
<span id="cb3-13"><a href=""></a><span class="do">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the analysis of variance table, we focus exclusively on the line <code>purchase:debttype</code>.</p>
<p>The <span class="math inline">\(F\)</span> statistic is 1.79; using the <span class="math inline">\(\mathsf{Fisher}\)</span> (1, 1497) distribution as null distribution, we obtain a <span class="math inline">\(p\)</span>-value of 0.18 so there is no evidence the effect of purchase depends on debt type.</p>
</section>
<section id="main-effects-and-marginalization" class="slide level2">
<h2>Main effects and marginalization</h2>
<p><strong>Main effects</strong> are comparisons between row or column averages</p>
<p>Obtained by <em>marginalization</em>, i.e., averaging over the other dimension.</p>
<p>Main effects are misleading if there is an interaction.</p>
<p>For example, the main effects of <span class="math inline">\(A\)</span> are:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">\(A\)</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">\(\text{row mean}\)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">\(a_1\)</td>
<td style="text-align: center; background-color: rgba(186, 225, 255, 255) !important;">\(\mu_{1.}\)</td>
</tr>
<tr class="even">
<td style="text-align: center;">\(a_2\)</td>
<td style="text-align: center; background-color: rgba(255, 223, 186, 255) !important;">\(\mu_{2.}\)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">\(a_3\)</td>
<td style="text-align: center; background-color: rgba(255, 179, 186, 255) !important;">\(\mu_{3.}\)</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="simple-effects" class="slide level2">
<h2>Simple effects</h2>
<p>When there are interactions, the effect of <span class="math inline">\(A\)</span> depends on the value of <span class="math inline">\(B\)</span>.</p>
<p><strong>Simple effects</strong> are comparisons between cell averages within a given row or column.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">\(A\)</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">\(b_1\)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">\(a_1\)</td>
<td style="text-align: center; background-color: rgba(186, 225, 255, 255) !important;">\(\mu_{11}\)</td>
</tr>
<tr class="even">
<td style="text-align: center;">\(a_2\)</td>
<td style="text-align: center; background-color: rgba(255, 223, 186, 255) !important;">\(\mu_{21}\)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">\(a_3\)</td>
<td style="text-align: center; background-color: rgba(255, 179, 186, 255) !important;">\(\mu_{31}\)</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="example-of-main-effects" class="slide level2">
<h2>Example of main effects</h2>
<p>Since the interaction is not significant, we can interpret the main effect of fixation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="co"># Pairwise comparisons within levels of purchase</span></span>
<span id="cb4-2"><a href=""></a><span class="co"># Using the main effects</span></span>
<span id="cb4-3"><a href=""></a>emmeans<span class="sc">::</span><span class="fu">emmeans</span>(mod, </span>
<span id="cb4-4"><a href=""></a>                 <span class="co"># what variable to keep (so average over "debttype")</span></span>
<span id="cb4-5"><a href=""></a>                 <span class="at">specs =</span> <span class="st">"purchase"</span>, </span>
<span id="cb4-6"><a href=""></a>                 <span class="at">contr =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb4-7"><a href=""></a><span class="do">## $emmeans</span></span>
<span id="cb4-8"><a href=""></a><span class="do">##  purchase      emmean    SE   df lower.CL upper.CL</span></span>
<span id="cb4-9"><a href=""></a><span class="do">##  discretionary    4.2 0.101 1497      4.0      4.4</span></span>
<span id="cb4-10"><a href=""></a><span class="do">##  need             5.6 0.101 1497      5.4      5.8</span></span>
<span id="cb4-11"><a href=""></a><span class="do">## </span></span>
<span id="cb4-12"><a href=""></a><span class="do">## Results are averaged over the levels of: debttype </span></span>
<span id="cb4-13"><a href=""></a><span class="do">## Confidence level used: 0.95 </span></span>
<span id="cb4-14"><a href=""></a><span class="do">## </span></span>
<span id="cb4-15"><a href=""></a><span class="do">## $contrasts</span></span>
<span id="cb4-16"><a href=""></a><span class="do">##  contrast             estimate    SE   df t.ratio p.value</span></span>
<span id="cb4-17"><a href=""></a><span class="do">##  discretionary - need    -1.42 0.143 1497  -9.900  &lt;.0001</span></span>
<span id="cb4-18"><a href=""></a><span class="do">## </span></span>
<span id="cb4-19"><a href=""></a><span class="do">## Results are averaged over the levels of: debttype</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-2---perceptions-of-cultural-appropriation-by-ideology" class="slide level2">
<h2>Example 2 - Perceptions of cultural appropriation by ideology</h2>
<p>We consider a three-way ANOVA from <span class="citation" data-cites="Lin.Kim.Uduehi.Keinan:2024">Lin et al. (<a href="#/references" role="doc-biblioref" onclick="">2024</a>)</span>. Their Study 4 focused on cultural appropriation for soul food recipe cookbook from Chef Dax, who was either black (or not), manipulating the description of the way he obtained the recipes (by peeking without permission in kitchens, by asking permission or no mention for control).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="fu">data</span>(LKUK24_S4, <span class="at">package =</span> <span class="st">"hecedsm"</span>)</span>
<span id="cb5-2"><a href=""></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(appropriation <span class="sc">~</span> politideo <span class="sc">*</span> chefdax <span class="sc">*</span> brandaction,</span>
<span id="cb5-3"><a href=""></a>   <span class="at">data =</span> LKUK24_S4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Authors postulated that the perception of appropriation would vary by political ideology (liberal or conservative). The study results in a 3 by 2 by 2 three-way ANOVA.</p>
</section>
<section id="example-2" class="slide level2">
<h2>Example 2</h2>
<p>For the <span class="math inline">\(K\)</span>-way ANOVA, we always start with estimating the full model with all <span class="math inline">\(K\)</span>-way interaction (provided there are enough data to estimate the latter, which implies there are repetitions).</p>
<div class="cell">
<div id="tbl-anova-LKUK24" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-LKUK24-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Analysis of variance table (type II decomposition) for the data from Study 4 of Lin et al.&nbsp;(2024).
</figcaption>
<div aria-describedby="tbl-anova-LKUK24-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">sum of squares</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">stat</th>
<th style="text-align: left;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">politideo</td>
<td style="text-align: right;">48.49</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">21.35</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">chefdax</td>
<td style="text-align: right;">473.72</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">208.61</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">brandaction</td>
<td style="text-align: right;">34.24</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">7.54</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">politideo:chefdax</td>
<td style="text-align: right;">65.00</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">28.63</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">politideo:brandaction</td>
<td style="text-align: right;">1.56</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: left;">0.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">chefdax:brandaction</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: left;">0.87</td>
</tr>
<tr class="odd">
<td style="text-align: left;">politideo:chefdax:brandaction</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: left;">0.86</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">1587.33</td>
<td style="text-align: right;">699</td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>There is no three-way interaction and a single two-way interaction between political ideology and the race of Chef Dax. We cannot interpret the <span class="math inline">\(p\)</span>-value for the main effect of <code>brandaction</code>, but we could look at the marginal means.</p>
</section>
<section id="dimension-reduction-and-simple-effects" class="slide level2">
<h2>Dimension reduction and simple effects</h2>
<p>Collapse to a 2 by 2 two-way ANOVA, averaging over <code>brandaction</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a><span class="co"># Marginal means for political ideology/Chef Dax</span></span>
<span id="cb6-2"><a href=""></a><span class="co"># Compute simple effects, by political ideology</span></span>
<span id="cb6-3"><a href=""></a><span class="fu">emmeans</span>(mod, </span>
<span id="cb6-4"><a href=""></a>         <span class="at">specs =</span> <span class="st">"chefdax"</span>, </span>
<span id="cb6-5"><a href=""></a>         <span class="at">by =</span> <span class="st">"politideo"</span>,</span>
<span id="cb6-6"><a href=""></a>         <span class="at">contrast =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb6-7"><a href=""></a><span class="do">## politideo = conservative:</span></span>
<span id="cb6-8"><a href=""></a><span class="do">##  chefdax   emmean    SE  df lower.CL upper.CL</span></span>
<span id="cb6-9"><a href=""></a><span class="do">##  not black    2.4 0.142 699      2.1      2.7</span></span>
<span id="cb6-10"><a href=""></a><span class="do">##  black        1.7 0.149 699      1.4      2.0</span></span>
<span id="cb6-11"><a href=""></a><span class="do">## </span></span>
<span id="cb6-12"><a href=""></a><span class="do">## politideo = liberal:</span></span>
<span id="cb6-13"><a href=""></a><span class="do">##  chefdax   emmean    SE  df lower.CL upper.CL</span></span>
<span id="cb6-14"><a href=""></a><span class="do">##  not black    3.6 0.097 699      3.4      3.8</span></span>
<span id="cb6-15"><a href=""></a><span class="do">##  black        1.6 0.095 699      1.4      1.8</span></span>
<span id="cb6-16"><a href=""></a><span class="do">## </span></span>
<span id="cb6-17"><a href=""></a><span class="do">## Results are averaged over the levels of: brandaction </span></span>
<span id="cb6-18"><a href=""></a><span class="do">## Confidence level used: 0.95</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpretation" class="slide level2">
<h2>Interpretation</h2>
<p>We see that the liberals are much more likely to view Chef Dax cookbook as an instance of cultural appropriation if he is not black; there is limited evidence of any difference between conservatives and liberal when Chef Dax is black.</p>
<p>Both differences are statistically significative, but the differences (and thus evidence of an effect) is much stronger for left-leaning respondents.</p>
</section>
<section id="comparisons-of-main-effects-of-brandaction" class="slide level2">
<h2>Comparisons of main effects of brandaction</h2>
<p>We expect participants will view peeking less favorably than if Chef Dax asked for permission to publish the recipes. It’s tricky to know the effect of the control, as we are not bringing the point to the attention of participants in this instance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="co"># Marginal mean for brandaction</span></span>
<span id="cb7-2"><a href=""></a>emm_brand <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(mod, <span class="at">specs =</span> <span class="fu">c</span>(<span class="st">"brandaction"</span>)) </span>
<span id="cb7-3"><a href=""></a>emm_brand</span>
<span id="cb7-4"><a href=""></a><span class="do">##  brandaction emmean    SE  df lower.CL upper.CL</span></span>
<span id="cb7-5"><a href=""></a><span class="do">##  peeking       2.56 0.108 699     2.35     2.77</span></span>
<span id="cb7-6"><a href=""></a><span class="do">##  permission    2.29 0.105 699     2.09     2.50</span></span>
<span id="cb7-7"><a href=""></a><span class="do">##  control       2.07 0.108 699     1.86     2.28</span></span>
<span id="cb7-8"><a href=""></a><span class="do">## </span></span>
<span id="cb7-9"><a href=""></a><span class="do">## Results are averaged over the levels of: politideo, chefdax </span></span>
<span id="cb7-10"><a href=""></a><span class="do">## Confidence level used: 0.95</span></span>
<span id="cb7-11"><a href=""></a><span class="co"># Joint F test for the main effect of brandaction</span></span>
<span id="cb7-12"><a href=""></a>emm_brand <span class="sc">|&gt;</span> <span class="fu">pairs</span>() <span class="sc">|&gt;</span> <span class="fu">joint_tests</span>()</span>
<span id="cb7-13"><a href=""></a><span class="do">##  model term df1 df2 F.ratio p.value</span></span>
<span id="cb7-14"><a href=""></a><span class="do">##  contrast     2 699   5.100  0.0064</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A joint <span class="math inline">\(F\)</span>-test, obtained by collapsing everything to a one-way ANOVA, shows that there are indeed differences.</p>
</section>
<section id="contrasts" class="slide level2">
<h2>Contrasts</h2>
<p>We can view the multiway ANOVA as a one-way analysis of variance with <span class="math inline">\(n_a \times n_b \times \cdots\)</span> levels, corresponding to each sub-group.</p>
<p>Marginal effects, interactions, and simple effects correspond to particular <strong>linear contrasts</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(likelihood <span class="sc">~</span> group,</span>
<span id="cb8-2"><a href=""></a>          <span class="at">data =</span> STC21_SS5 <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href=""></a>            dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">interaction</span>(debttype, purchase)))</span>
<span id="cb8-4"><a href=""></a><span class="fu">emmeans</span>(mod, <span class="at">specs =</span> <span class="st">"group"</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-5"><a href=""></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="fu">list</span>(<span class="at">main_pairwise =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb8-6"><a href=""></a><span class="do">##  contrast      estimate    SE   df t.ratio p.value</span></span>
<span id="cb8-7"><a href=""></a><span class="do">##  main_pairwise      0.5 0.143 1497   3.500  0.0005</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="recap-1" class="slide level2">
<h2>Recap 1</h2>
<ul>
<li>Interactions occur when the effect of a variable depend on another: we typically model this by adding the product of the two (one or more being categorical with dummy indicators).</li>
<li><strong>Interaction plots</strong>, showing group averages, are useful conceptually to look for interactions, but formal tests are needed.</li>
<li>Tests of statistical significance consider removal of interactions based on fitting the complete model (when possible).</li>
<li>The marginality principle implies we keep all lower effects: use type II effects.</li>
</ul>
</section>
<section id="recap-2" class="slide level2">
<h2>Recap 2</h2>
<ul>
<li>Analysis of variance models are simply linear regression models with categorical explanatories.</li>
<li>The models with all interactions correspond to each subgroup having a specific average.</li>
<li>We compare of main effects (if interactions are not present) or simple effects (when they are), or more general contrasts, based on the full model.</li>
<li>A multiway ANOVA can always be cast as a one-way ANOVA.</li>
</ul>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>
<div class="quarto-auto-generated-content">
<p><img src="fig/logo_hec_montreal_bleu_web.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Lin.Kim.Uduehi.Keinan:2024" class="csl-entry" role="listitem">
Lin, Jason D, Nicole You Jeung Kim, Esther Uduehi, and Anat Keinan. 2024. <span>“Culture for Sale: Unpacking Consumer Perceptions of Cultural Appropriation.”</span> <em>Journal of Consumer Research</em>. <a href="https://doi.org/10.1093/jcr/ucad076">https://doi.org/10.1093/jcr/ucad076</a>.
</div>
<div id="ref-Sharma.Tully.Cryder:2021" class="csl-entry" role="listitem">
Sharma, Eesha, Stephanie Tully, and Cynthia Cryder. 2021. <span>“Psychological Ownership of (Borrowed) Money.”</span> <em>Journal of Marketing Research</em> 58 (3): 497–514. <a href="https://doi.org/10.1177/0022243721993816">https://doi.org/10.1177/0022243721993816</a>.
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="MATH60604A-slides5a_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="MATH60604A-slides5a_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="MATH60604A-slides5a_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="MATH60604A-slides5a_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="MATH60604A-slides5a_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="MATH60604A-slides5a_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="MATH60604A-slides5a_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="MATH60604A-slides5a_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="MATH60604A-slides5a_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="MATH60604A-slides5a_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>