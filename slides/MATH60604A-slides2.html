<!DOCTYPE html>
<html lang="en"><head>
<script src="MATH60604A-slides2_files/libs/clipboard/clipboard.min.js"></script>
<script src="MATH60604A-slides2_files/libs/quarto-html/tabby.min.js"></script>
<script src="MATH60604A-slides2_files/libs/quarto-html/popper.min.js"></script>
<script src="MATH60604A-slides2_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="MATH60604A-slides2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="MATH60604A-slides2_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="MATH60604A-slides2_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="MATH60604A-slides2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.56">

  <meta name="author" content="Léo Belzile, HEC Montréal">
  <meta name="dcterms.date" content="2024-01-01">
  <title>Statistical modelling</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="MATH60604A-slides2_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="MATH60604A-slides2_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="MATH60604A-slides2_files/libs/revealjs/dist/theme/quarto.css">
  <link href="MATH60604A-slides2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="MATH60604A-slides2_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="MATH60604A-slides2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="MATH60604A-slides2_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#002855" class="quarto-title-block center">
  <h1 class="title">Statistical modelling</h1>
  <p class="subtitle">02. Likelihood-based inference</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Léo Belzile, HEC Montréal 
</div>
</div>
</div>

  <p class="date">2024</p>
</section>
<section id="motivating-example" class="slide level2">
<h2>Motivating example</h2>
<p>The data <code>waiting</code> contain the time in seconds from 17:59 until the next metro train departs from station <em>Université de Montréal</em> on the blue line of the Montreal subway, collected over three months (62 week days). The observations are positive and range from <span class="math inline">\(4\)</span> to <span class="math inline">\(57\)</span> seconds.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="fu">data</span>(waiting, <span class="at">package =</span> <span class="st">"hecstatmod"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="MATH60604A-slides2_files/figure-revealjs/fig-waiting-hist-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:80.0%"><p class="caption">
Figure&nbsp;1: Histogram of waiting time with rugs for the observations.
</p></section>
<section id="statistical-model" class="slide level2">
<h2>Statistical model</h2>
<p>Our starting point for a statistical model is a <strong>data generating process</strong>.</p>
<p>We postulate that the data <span class="math inline">\(\boldsymbol{y}\)</span> originates from a probability distribution with (unknown) <span class="math inline">\(p\)</span>-dimensional parameter vector <span class="math inline">\(\boldsymbol{\theta} \in \boldsymbol{\Theta} \subseteq \mathbb{R}^p\)</span>.</p>
<p>Assuming that data are <em>independent</em>, the joint density or mass function factorizes <span class="math display">\[\begin{align*}
f(\boldsymbol{y}; \boldsymbol{\theta}) = \prod_{i=1}^n f_i(y_i; \boldsymbol{\theta}) = f_1(y_1; \boldsymbol{\theta}) \times \cdots \times f_n(y_n; \boldsymbol{\theta}).
\end{align*}\]</span> If data are identically distributed, then all marginal densities are the same, meaning <span class="math inline">\(f_1(\cdot) = \cdots f_n(\cdot)\)</span>.</p>
</section>
<section id="exponential-model-for-waiting-times" class="slide level2">
<h2>Exponential model for waiting times</h2>
<p>To model the waiting time, we may consider for example an exponential distribution <span class="math inline">\(Y_i \stackrel{\mathrm{iid}}{\sim}\mathsf{exp}(\lambda)\)</span> with scale <span class="math inline">\(\lambda&gt;0\)</span>, whose density is <span class="math display">\[f(x) =\lambda^{-1}\exp(-x/\lambda), \qquad x \ge 0.\]</span> The expected value equals the scale, so <span class="math inline">\(\mathsf{E}(Y)=\lambda\)</span>.</p>
</section>
<section id="exponential-model-density" class="slide level2">
<h2>Exponential model density</h2>
<p>Under the exponential model, the joint density for the observations <span class="math inline">\(y_1, \ldots, y_n\)</span> is <span class="math display">\[\begin{align*}
f(\boldsymbol{y}) = \prod_{i=1}^n f(y_i) =\prod_{i=1}^n  \lambda^{-1} \exp(- y_i/\lambda) = \lambda^{-n} \exp\left(- \sum_{i=1}^n y_i/\lambda\right)
\end{align*}\]</span> The sample space is <span class="math inline">\(\mathbb{R}_{+}^n = [0, \infty)^n,\)</span> while the parameter space is <span class="math inline">\((0, \infty).\)</span></p>
<p>To estimate the scale parameter <span class="math inline">\(\lambda\)</span> and obtain suitable uncertainty measures, we need a <strong>modelling framework</strong>.</p>
</section>
<section id="likelihood" class="slide level2">
<h2>Likelihood</h2>
<div id="def-lik" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (Likelihood)</strong></span> The <strong>likelihood</strong> <span class="math inline">\(L(\boldsymbol{\theta})\)</span> is a function of the parameter vector <span class="math inline">\(\boldsymbol{\theta}\)</span> that gives the probability (or density) of observing a sample under a postulated distribution, treating the observations as fixed, <span class="math display">\[\begin{align*}
L(\boldsymbol{\theta}; \boldsymbol{y}) = f(\boldsymbol{y}; \boldsymbol{\theta}),
\end{align*}\]</span> where <span class="math inline">\(f(\boldsymbol{y}; \boldsymbol{\theta})\)</span> denotes the joint density or mass function of the <span class="math inline">\(n\)</span>-vector containing the observations.</p>
</div>
<p>In practice, we often work with the <strong>log likelihood</strong> <span class="math inline">\(\ell(\boldsymbol{\theta}; \boldsymbol{y}) = \ln L(\boldsymbol{\theta}; \boldsymbol{y})\)</span>.</p>
</section>
<section id="exponential-log-likelihood" class="slide level2">
<h2>Exponential log likelihood</h2>
<p>The log likelihood function for independent and identically distributions observations is <span class="math display">\[\begin{align*}
\ell(\boldsymbol{\theta}; \boldsymbol{y}) = \sum_{i=1}^n \ln f(y_i; \boldsymbol{\theta})
\end{align*}\]</span> so for the exponential model, <span class="math display">\[\begin{align*}
\ell(\lambda) = -n \ln\lambda -\frac{1}{\lambda} \sum_{i=1}^n y_i.
\end{align*}\]</span></p>
</section>
<section id="maximum-likelihood-estimator" class="slide level2">
<h2>Maximum likelihood estimator</h2>
<div id="def-mle" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2</strong></span> The <strong>maximum likelihood estimator</strong> (MLE) <span class="math inline">\(\widehat{\boldsymbol{\theta}}\)</span> is the vector value that maximizes the likelihood,<sup>1</sup> <span class="math display">\[\begin{align*}
\widehat{\boldsymbol{\theta}} = \mathrm{arg max}_{\boldsymbol{\theta} \in \boldsymbol{\Theta}} L(\boldsymbol{\theta}; \boldsymbol{y}) = \mathrm{arg max}_{\boldsymbol{\theta} \in \boldsymbol{\Theta}} \ell(\boldsymbol{\theta}; \boldsymbol{y}).
\end{align*}\]</span></p>
</div>
<aside><ol class="aside-footnotes"><li id="fn1"><p>The natural logarithm <span class="math inline">\(\ln\)</span> is a monotonic transformation, so the MLE is best calculated on the log scale to avoid numerical underflow.</p></li></ol></aside></section>
<section id="intuition-behind-maximum-likelihood" class="slide level2">
<h2>Intuition behind maximum likelihood</h2>
<p>In the discrete setting, the mass function gives the probability of an outcome.</p>
<p>We want to find the parameter values that make the data the most <strong>likely</strong> to have been generated.</p>
<blockquote>
<p>Whatever we observe, we have expected to observe</p>
</blockquote>
</section>
<section id="deriving-the-mle" class="slide level2">
<h2>Deriving the MLE</h2>
<p>We can use calculus to find the maximum of the function <span class="math inline">\(\ell(\lambda)\)</span>.</p>
<p>Taking first derivative and setting the result to zero, we find <span class="math display">\[\begin{align*}
\frac{\mathrm{d} \ell(\lambda)}{\mathrm{d} \lambda}  = -\frac{n}{\lambda} + \frac{1}{\lambda^2} \sum_{i=1}^n y_i = 0.
\end{align*}\]</span> and solving for <span class="math inline">\(\lambda\)</span> gives <span class="math inline">\(\widehat{\lambda} = \sum_{i=1}^n y_i / n.\)</span></p>
<p>The second derivative of the log likelihood is <span class="math inline">\(\mathrm{d}^2 \ell(\lambda)/\mathrm{d} \lambda^2 = n(\lambda^{-2} - 2\lambda^{-3}\overline{y}),\)</span> and plugging <span class="math inline">\(\lambda = \overline{y}\)</span> gives <span class="math inline">\(-n/\overline{y}^2,\)</span> which is negative. Therefore, <span class="math inline">\(\widehat{\lambda}\)</span> is indeed a maximizer.</p>
</section>
<section id="exponential-log-likelihood-and-mle" class="slide level2">
<h2>Exponential log likelihood and MLE</h2>

<img data-src="MATH60604A-slides2_files/figure-revealjs/fig-loglik-exp-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><p class="caption">
Figure&nbsp;2: Exponential log likelihood function for the waiting time, with the maximum likelihood estimate at dashed vertical line (right).
</p></section>
<section id="invariance-of-maximum-likelihood-estimators" class="slide level2">
<h2>Invariance of maximum likelihood estimators</h2>
<p>If <span class="math inline">\(g(\boldsymbol{\theta}): \mathbb{R}^p \mapsto \mathbb{R}^k\)</span> for <span class="math inline">\(k \leq p\)</span> is a function of the parameter vector, then <span class="math inline">\(g(\widehat{\boldsymbol{\theta}})\)</span> is the maximum likelihood estimator of <span class="math inline">\(g(\boldsymbol{\theta})\)</span>.</p>
<p>For example, we could compute the maximum likelihood estimate of the probability of waiting more than one minute, <span class="math inline">\(\Pr(T&gt;60) = \exp(-60/\widehat{\lambda})= 0.126,\)</span> or using <strong>R</strong> built-in distribution function <code>pexp</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="co"># Note: default R parametrization for the exponential is </span></span>
<span id="cb2-2"><a href=""></a><span class="co"># in terms of rate, i.e., the inverse scale parameter</span></span>
<span id="cb2-3"><a href=""></a><span class="fu">pexp</span>(<span class="at">q =</span> <span class="dv">60</span>, <span class="at">rate =</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(waiting), <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-4"><a href=""></a><span class="do">## [1] 0.126</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pick whichever parametrization is most convenient for the optimization!</p>
</section>
<section id="score-vector" class="slide level2">
<h2>Score vector</h2>
<p>The gradient of the log likelihood <span class="math display">\[\begin{align*}
U(\boldsymbol{\theta}) = \frac{\partial \ell(\boldsymbol{\theta}; \boldsymbol{y})}{\partial \boldsymbol{\theta}}
\end{align*}\]</span> is termed <strong>score</strong> function.</p>
<p>Under regularity conditions (see Chapter 4 of <span class="citation" data-cites="Davison:2003">Davison (<a href="#/references" role="doc-biblioref" onclick="">2003</a>)</span>), the MLE solves the score equation <span class="math display">\[\begin{align*}
U(\widehat{\boldsymbol{\theta}})=0.
\end{align*}\]</span></p>
</section>
<section id="information" class="slide level2">
<h2>Information</h2>
<p>How do we measure the precision of our estimator? The observation matrices encode the curvature of the log likelihood and provide information about the variability of <span class="math inline">\(\widehat{\boldsymbol{\theta}}.\)</span></p>
<p>The <strong>observed information matrix</strong> is the hessian of the negative log likelihood <span class="math display">\[\begin{align*}
j(\boldsymbol{\theta}; \boldsymbol{y})=-\frac{\partial^2 \ell(\boldsymbol{\theta}; \boldsymbol{y})}{\partial \boldsymbol{\theta} \partial \boldsymbol{\theta}^\top},
\end{align*}\]</span> evaluated at the maximum likelihood estimate <span class="math inline">\(\widehat{\boldsymbol{\theta}},\)</span> so <span class="math inline">\(j(\widehat{\boldsymbol{\theta}}).\)</span> Under regularity conditions, the <strong>expected information</strong>, also called <strong>Fisher information</strong> matrix, is <span class="math display">\[\begin{align*}
i(\boldsymbol{\theta}) = \mathsf{E}\left\{U(\boldsymbol{\theta}; \boldsymbol{Y}) U(\boldsymbol{\theta}; \boldsymbol{Y})^\top\right\} = \mathsf{E}\left\{j(\boldsymbol{\theta}; \boldsymbol{Y})\right\}
\end{align*}\]</span> Both the Fisher (or expected) and the observed information matrices are symmetric.</p>
</section>
<section id="observed-and-expected-information-matrix-for-exponential-data" class="slide level2">
<h2>Observed and expected information matrix for exponential data</h2>
<p>The observed and expected information of the exponential model for a random sample <span class="math inline">\(Y_1, \ldots, Y_n,\)</span> parametrized in terms of scale <span class="math inline">\(\lambda,\)</span> are <span class="math display">\[\begin{align*}
j(\lambda; \boldsymbol{y}) &amp;= -\frac{\partial^2 \ell(\lambda)}{\partial \lambda^2} = \frac{n}{\lambda^{2}} + \frac{2}{n\lambda^{3}}\sum_{i=1}^n y_i \\
i(\lambda) &amp;= \frac{n}{\lambda^{2}} + \frac{2}{n\lambda^{3}}\sum_{i=1}^n \mathsf{E}(Y_i)  = \frac{n}{\lambda^{2}}
\end{align*}\]</span> since <span class="math inline">\(\mathsf{E}(Y_i) = \lambda\)</span> and expectation is a linear operator. Both expected and observed information matrix coincide when evaluated at the maximum likelihood estimator, <span class="math inline">\(i(\widehat{\lambda}) = j(\widehat{\lambda}) = n/\overline{y}^2\)</span> for <span class="math inline">\(\widehat{\lambda}=\overline{y}\)</span> (i.e., the sample mean), but this isn’t the case in general.</p>
</section>
<section id="maximization-of-the-likelihood" class="slide level2">
<h2>Maximization of the likelihood</h2>
<ul>
<li>To obtain the maximum likelihood estimator, we will typically find the value of the vector <span class="math inline">\(\boldsymbol{\theta}\)</span> that solves the score vector, meaning <span class="math inline">\(U(\widehat{\boldsymbol{\theta}})=\boldsymbol{0}_p.\)</span></li>
<li>This amounts to solving simultaneously a <span class="math inline">\(p\)</span>-system of equations by setting the derivative with respect to each element of <span class="math inline">\(\boldsymbol{\theta}\)</span> to zero.</li>
<li>If <span class="math inline">\(j(\widehat{\boldsymbol{\theta}})\)</span> is a positive definite matrix (i.e., all of it’s eigenvalues are positive), then the vector <span class="math inline">\(\widehat{\boldsymbol{\theta}}\)</span> is the maximum likelihood estimator.</li>
</ul>
</section>
<section id="gradient-based-optimization-newtonraphson-algorithm" class="slide level2">
<h2>Gradient-based optimization (Newton–Raphson algorithm)</h2>
<p>If we consider an initial value <span class="math inline">\(\boldsymbol{\theta}^{\dagger},\)</span> then under suitable <strong>regularity conditions</strong>, a first order Taylor series expansion of the score in a neighborhood <span class="math inline">\(\boldsymbol{\theta}^{\dagger}\)</span> of the MLE <span class="math inline">\(\widehat{\boldsymbol{\theta}}\)</span> gives <span class="math display">\[\begin{align*}
\boldsymbol{0}_p &amp; = U(\widehat{\boldsymbol{\theta}}) \stackrel{\cdot}{\simeq} \left.
\frac{\partial \ell(\boldsymbol{\theta})}{\partial \boldsymbol{\theta}} \right|_{\boldsymbol{\theta} = \boldsymbol{\theta}^{\dagger}} + \left.
\frac{\partial^2 \ell(\boldsymbol{\theta})}{\partial \boldsymbol{\theta} \partial \boldsymbol{\theta}^\top}\right|_{\boldsymbol{\theta} = \boldsymbol{\theta}^{\dagger}}(\widehat{\boldsymbol{\theta}} - \boldsymbol{\theta}^{\dagger})\\&amp;=U(\boldsymbol{\theta}^{\dagger}) - j(\boldsymbol{\theta}^{\dagger})(\widehat{\boldsymbol{\theta}} - \boldsymbol{\theta}^{\dagger})
\end{align*}\]</span> and solving this for <span class="math inline">\(\widehat{\boldsymbol{\theta}}\)</span> (provided the <span class="math inline">\(p \times p\)</span> matrix <span class="math inline">\(j(\widehat{\boldsymbol{\theta}})\)</span> is invertible), we get <span class="math display">\[\begin{align*}
\widehat{\boldsymbol{\theta}} \stackrel{\cdot}{\simeq} \boldsymbol{\theta}^{\dagger} +
j^{-1}(\boldsymbol{\theta}^{\dagger})U(\boldsymbol{\theta}^{\dagger}),
\end{align*}\]</span> which suggests an iterative procedure from a starting value <span class="math inline">\(\boldsymbol{\theta}^{\dagger}\)</span> in the vicinity of the mode until the gradient is approximately zero.</p>
</section>
<section id="weibull-distribution" class="slide level2">
<h2>Weibull distribution</h2>
<p>The distribution function of a <strong>Weibull</strong> random variable with scale <span class="math inline">\(\lambda&gt;0\)</span> and shape <span class="math inline">\(\alpha&gt;0\)</span> is <span class="math display">\[\begin{align*}
F(x; \lambda, \alpha) &amp;= 1 - \exp\left\{-(x/\lambda)^\alpha\right\}, \qquad x \geq 0, \lambda&gt;0, \alpha&gt;0,
\end{align*}\]</span> while the corresponding density is <span class="math display">\[\begin{align*}
f(x; \lambda, \alpha) &amp;= \frac{\alpha}{\lambda^\alpha} x^{\alpha-1}\exp\left\{-(x/\lambda)^\alpha\right\}, \qquad x \geq 0, \lambda&gt;0, \alpha&gt;0.
\end{align*}\]</span> The Weibull distribution includes the exponential as special case when <span class="math inline">\(\alpha=1.\)</span> The expected value of <span class="math inline">\(Y \sim \mathsf{Weibull}(\lambda, \alpha)\)</span> is <span class="math inline">\(\mathsf{E}(Y) = \lambda \Gamma(1+1/\alpha).\)</span></p>
</section>
<section id="maximum-likelihood-of-a-weibull-sample" class="slide level2 smaller">
<h2>Maximum likelihood of a Weibull sample</h2>
<p>The log likelihood for the <span class="math inline">\(\mathsf{Weibull}(\lambda, \alpha)\)</span> model is <span class="math display">\[\begin{align*}
\ell(\lambda, \alpha) = n \ln(\alpha) - n\alpha\ln(\lambda) + (\alpha-1) \sum_{i=1}^n \ln y_i  - \lambda^{-\alpha}\sum_{i=1}^n y_i^\alpha.
\end{align*}\]</span> The gradient of this function is easily obtained by differentiation <span class="math display">\[\begin{align*}
\frac{\partial \ell(\lambda, \alpha)}{\partial \lambda} &amp;= -\frac{n\alpha}{\lambda} +\alpha\lambda^{-\alpha-1}\sum_{i=1}^n y_i^\alpha \\
\frac{\partial \ell(\lambda, \alpha)}{\partial \alpha} &amp;= \frac{n}{\alpha} - n \ln(\lambda) + \sum_{i=1}^n \ln y_i  - \sum_{i=1}^n \left(\frac{y_i}{\lambda}\right)^{\alpha} \times\ln\left(\frac{y_i}{\lambda}\right).
\end{align*}\]</span></p>
<div title="**R** demo">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>R</strong> demo</strong></p>
</div>
<div class="callout-content">
<p>Numerical optimization to obtain the maximum likelihood estimate of the Weibull distribution (no closed-form expression for the MLE).</p>
</div>
</div>
</div>
</div>
</section>
<section id="quantile-quantile-plot" class="slide level2">
<h2>Quantile quantile plot</h2>
<p>A quantile-quantile plot shows</p>
<ul>
<li>on the <span class="math inline">\(x\)</span>-axis, the theoretical quantiles <span class="math inline">\(\widehat{F}^{-1}\{i/(n+1)\}\)</span>, where <span class="math inline">\(\widehat{F}^{-1}\)</span> denotes the quantile function of the estimated model</li>
<li>on the <span class="math inline">\(y\)</span>-axis, the ordered empirical quantiles <span class="math inline">\(y_{(1)} \leq \cdots y_{(n)}\)</span></li>
</ul>
<p>If the model is adequate, the ordered values should follow a straight line with unit slope passing through the origin.</p>
</section>
<section id="optimization-routines" class="slide level2">
<h2>Optimization routines</h2>
<p>The <code>MASS</code> package includes some wrappers to estimate models</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="co"># Estimate parameters via optimization routine</span></span>
<span id="cb3-2"><a href=""></a>fit_weibull <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">fitdistr</span>(<span class="at">x =</span> waiting, <span class="at">densfun =</span> <span class="st">"weibull"</span>)</span>
<span id="cb3-3"><a href=""></a><span class="co"># Extract parameters</span></span>
<span id="cb3-4"><a href=""></a>fit_weibull<span class="sc">$</span>estimate</span>
<span id="cb3-5"><a href=""></a><span class="do">## shape scale </span></span>
<span id="cb3-6"><a href=""></a><span class="do">##   2.6  32.6</span></span>
<span id="cb3-7"><a href=""></a></span>
<span id="cb3-8"><a href=""></a><span class="co"># Compute positions for QQ plot</span></span>
<span id="cb3-9"><a href=""></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(waiting) <span class="co"># sample size</span></span>
<span id="cb3-10"><a href=""></a>xpos <span class="ot">&lt;-</span> <span class="fu">qweibull</span>( <span class="co"># quantile function</span></span>
<span id="cb3-11"><a href=""></a>  <span class="at">p =</span> <span class="fu">ppoints</span>(n), <span class="co"># pseudo uniform variables</span></span>
<span id="cb3-12"><a href=""></a>  <span class="at">shape =</span> fit_weibull<span class="sc">$</span>estimate[<span class="st">'shape'</span>],</span>
<span id="cb3-13"><a href=""></a>  <span class="at">scale =</span> fit_weibull<span class="sc">$</span>estimate[<span class="st">'scale'</span>])</span>
<span id="cb3-14"><a href=""></a>ypos <span class="ot">&lt;-</span> <span class="fu">sort</span>(waiting)</span>
<span id="cb3-15"><a href=""></a><span class="co">#plot(x = xpos, y = ypos, panel.first = {abline(a = 0, b = 1)})</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="goodness-of-fit-checks" class="slide level2">
<h2>Goodness-of-fit checks</h2>

<img data-src="MATH60604A-slides2_files/figure-revealjs/fig-qqplots-weibull-exp-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">
Figure&nbsp;3: Quantile-quantile plots for exponential (left) and Weibull (right) models, with 95% pointwise simulation intervals.
</p></section>
<section id="sampling-distribution" class="slide level2">
<h2>Sampling distribution</h2>
<p>The <strong>sampling distribution</strong> of an estimator <span class="math inline">\(\widehat{\boldsymbol{\theta}}\)</span> is the probability distribution induced by the underlying data (<em>recall that the data inputs are random, so the output is random too</em>).</p>
<p>Denote the true value of the parameter vector <span class="math inline">\(\boldsymbol{\theta}_0.\)</span> Under suitable regularity conditions, an application of the central limit gives <span class="math display">\[\begin{align*}
i(\boldsymbol{\theta}_0)^{-1/2}U(\boldsymbol{\theta}_0) \stackrel{\cdot}{\sim}\mathsf{normal}_p(\boldsymbol{0}_p, \mathsf{I}_p).
\end{align*}\]</span></p>
<p>Similar approximations for the sampling distribution of <span class="math inline">\(\widehat{\boldsymbol{\theta}}\)</span> show that <span class="math display">\[\begin{align*}
\widehat{\boldsymbol{\theta}} \stackrel{\cdot}{\sim} \mathsf{normal}_p\{\boldsymbol{\theta}_0, i^{-1}(\boldsymbol{\theta})\}
\end{align*}\]</span> where the covariance matrix is the inverse of the Fisher information.<sup>1</sup></p>
<aside><ol class="aside-footnotes"><li id="fn2"><p> In practice, the true parameter value <span class="math inline">\(\boldsymbol{\theta}_0\)</span> is unknown, so we evaluate the information at the MLE <span class="math inline">\(\widehat{\boldsymbol{\theta}}\)</span>. This is justified by the fact that both the expected and observed information, <span class="math inline">\(i(\widehat{\boldsymbol{\theta}})\)</span> and <span class="math inline">\(j(\widehat{\boldsymbol{\theta}})\)</span>, converge to <span class="math inline">\(i(\boldsymbol{\theta}_0)\)</span> as <span class="math inline">\(n \to \infty\)</span>.</p></li></ol></aside></section>
<section id="covariance-matrix-and-standard-errors-for-the-weibull-distribution" class="slide level2">
<h2>Covariance matrix and standard errors for the Weibull distribution</h2>
<p>We can use these results for statistical inference! The standard errors are simply the square root of the diagonal entries of the inverse Hessian matrix, <span class="math inline">\(\mathrm{se}(\widehat{\boldsymbol{\theta}})=[\mathrm{diag}\{j^{-1}(\widehat{\boldsymbol{\theta}})\}]^{1/2}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="co"># 'opt_weibull' is the result of the optimization routine</span></span>
<span id="cb4-2"><a href=""></a><span class="co"># which minimizes the negative of the log likelihood</span></span>
<span id="cb4-3"><a href=""></a><span class="co"># The Hessian matrix of the negative log likelihood</span></span>
<span id="cb4-4"><a href=""></a><span class="co"># is evaluated at the MLE (observed information)</span></span>
<span id="cb4-5"><a href=""></a>(mle_weibull <span class="ot">&lt;-</span> opt_weibull<span class="sc">$</span>par)</span>
<span id="cb4-6"><a href=""></a><span class="do">## [1] 32.6  2.6</span></span>
<span id="cb4-7"><a href=""></a>(obsinfo_weibull <span class="ot">&lt;-</span> opt_weibull<span class="sc">$</span>hessian)</span>
<span id="cb4-8"><a href=""></a><span class="do">##        [,1]   [,2]</span></span>
<span id="cb4-9"><a href=""></a><span class="do">## [1,]  0.396 -0.818</span></span>
<span id="cb4-10"><a href=""></a><span class="do">## [2,] -0.818 16.998</span></span>
<span id="cb4-11"><a href=""></a><span class="co"># Covariance matrix is inverse of information</span></span>
<span id="cb4-12"><a href=""></a>(vmat_weibull <span class="ot">&lt;-</span> <span class="fu">solve</span>(obsinfo_weibull))</span>
<span id="cb4-13"><a href=""></a><span class="do">##       [,1]   [,2]</span></span>
<span id="cb4-14"><a href=""></a><span class="do">## [1,] 2.804 0.1349</span></span>
<span id="cb4-15"><a href=""></a><span class="do">## [2,] 0.135 0.0653</span></span>
<span id="cb4-16"><a href=""></a><span class="co"># Standard errors</span></span>
<span id="cb4-17"><a href=""></a>(se_weibull <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(vmat_weibull)))</span>
<span id="cb4-18"><a href=""></a><span class="do">## [1] 1.675 0.256</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="wald-based-confidence-intervals" class="slide level2">
<h2>Wald-based confidence intervals</h2>
<p>From these, one can readily <span class="math inline">\((1-\alpha)\)</span> Wald-based confidence intervals for parameters from <span class="math inline">\(\boldsymbol{\theta}\)</span>, where for <span class="math inline">\(\theta_j\)</span> <span class="math inline">\((j=1, \ldots, p)\)</span>, <span class="math display">\[\begin{align*}
\widehat{\theta}_j \pm \mathfrak{z}_{1-\alpha/2}\mathrm{se}(\widehat{\theta}_j),
\end{align*}\]</span> where <span class="math inline">\(\mathfrak{z}_{1-\alpha/2}\)</span> is the <span class="math inline">\(1-\alpha/2\)</span> quantile of the standard normal distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="co"># Confidence intervals for lambda and alpha</span></span>
<span id="cb5-2"><a href=""></a>mle_weibull[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))<span class="sc">*</span>se_weibull[<span class="dv">1</span>]</span>
<span id="cb5-3"><a href=""></a><span class="do">## [1] 29.3 35.8</span></span>
<span id="cb5-4"><a href=""></a>mle_weibull[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))<span class="sc">*</span>se_weibull[<span class="dv">2</span>]</span>
<span id="cb5-5"><a href=""></a><span class="do">## [1] 2.1 3.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These confidence intervals are symmetric.</p>
</section>
<section id="delta-method-and-transformations" class="slide level2">
<h2>Delta-method and transformations</h2>
<p>The asymptotic normality result can be used to derive standard errors for other quantities of interest.</p>
<p>If <span class="math inline">\(\phi = g(\boldsymbol{\theta})\)</span>, where <span class="math inline">\(g: \mathbb{R}^p \to \mathbb{R}^k\)</span> for <span class="math inline">\(k \leq p\)</span> is a differentiable function of <span class="math inline">\(\boldsymbol{\theta}\)</span> non-vanishing at <span class="math inline">\(\boldsymbol{\theta}_0\)</span> then <span class="math display">\[\widehat{\phi} \stackrel{\cdot}{\sim}\mathsf{normal}(\phi_0, \nabla \phi^\top i(\boldsymbol{\theta}_0)^{-1} \nabla \phi),\]</span> where <span class="math display">\[\nabla \phi=[\partial \phi/\partial \theta_1, \ldots, \partial \phi/\partial \theta_p]^\top.\]</span></p>
<p>The variance matrix and the jacobian are evaluated at the maximum likelihood estimate <span class="math inline">\(\widehat{\boldsymbol{\theta}}.\)</span></p>
</section>
<section id="probability-of-waiting-for-exponential-model." class="slide level2">
<h2>Probability of waiting for exponential model.</h2>
<p>Consider the probability of waiting more than one minute, <span class="math inline">\(\phi=g(\lambda) = \exp(-60/\lambda).\)</span> The maximum likelihood estimate is, by invariance, <span class="math inline">\(0.126\)</span> and the gradient of <span class="math inline">\(g\)</span> with respect to the scale parameter is <span class="math inline">\(\nabla \phi = \partial \phi / \partial \lambda = 60\exp(-60/\lambda)/\lambda^2.\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a>lambda_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(waiting)</span>
<span id="cb6-2"><a href=""></a>phi_hat <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">60</span><span class="sc">/</span>lambda_hat)</span>
<span id="cb6-3"><a href=""></a><span class="co"># Derivative of phi wrt lambda</span></span>
<span id="cb6-4"><a href=""></a>dphi <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){<span class="dv">60</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">60</span><span class="sc">/</span>lambda)<span class="sc">/</span>(lambda<span class="sc">^</span><span class="dv">2</span>)}</span>
<span id="cb6-5"><a href=""></a><span class="co"># Inverse of observed information</span></span>
<span id="cb6-6"><a href=""></a>V_lambda <span class="ot">&lt;-</span> lambda_hat<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">length</span>(waiting)</span>
<span id="cb6-7"><a href=""></a><span class="co"># Variance of phi</span></span>
<span id="cb6-8"><a href=""></a>V_phi <span class="ot">&lt;-</span> <span class="fu">dphi</span>(lambda_hat)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> V_lambda</span>
<span id="cb6-9"><a href=""></a><span class="co"># Standard error of phi</span></span>
<span id="cb6-10"><a href=""></a>(se_phi <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(V_phi))</span>
<span id="cb6-11"><a href=""></a><span class="do">## [1] 0.0331</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="comparison-of-nested-models" class="slide level2">
<h2>Comparison of nested models</h2>
<ul>
<li><p>We consider a null hypothesis <span class="math inline">\(\mathscr{H}_0\)</span> that imposes restrictions on the possible values of <span class="math inline">\(\boldsymbol{\theta}\)</span> can take, relative to an unconstrained alternative <span class="math inline">\(\mathscr{H}_a.\)</span></p></li>
<li><p>There are two <strong>nested</strong> models: a <em>full</em> model (alternative), and a <em>reduced</em> or null model that is a subset of the full model where we impose <span class="math inline">\(q\)</span> restrictions on the parameters.</p></li>
<li><p>For example, the exponential distribution is a special case of the Weibull distribution if <span class="math inline">\(\alpha=1\)</span>.</p></li>
</ul>
</section>
<section id="likelihood-tests" class="slide level2">
<h2>Likelihood tests</h2>
<p>Recall that the null hypothesis <span class="math inline">\(\mathscr{H}_0\)</span> tested is “the reduced model is an <strong>adequate simplification</strong> of the full model”.</p>
<p>The likelihood provides three main classes of statistics for testing this hypothesis, namely</p>
<ul>
<li>likelihood ratio tests statistics, denoted <span class="math inline">\(R,\)</span> which measure the drop in log likelihood (vertical distance) from <span class="math inline">\(\ell(\widehat{\boldsymbol{\theta}})\)</span> and <span class="math inline">\(\ell(\widehat{\boldsymbol{\theta}}_0).\)</span></li>
<li>Wald tests statistics, denoted <span class="math inline">\(W,\)</span> which consider the standardized horizontal distance between <span class="math inline">\(\widehat{\boldsymbol{\theta}}\)</span> and <span class="math inline">\(\widehat{\boldsymbol{\theta}}_0.\)</span></li>
<li>score tests statistics, denoted <span class="math inline">\(S,\)</span> which looks at the scaled slope of <span class="math inline">\(\ell,\)</span> evaluated <em>only</em> at <span class="math inline">\(\widehat{\boldsymbol{\theta}}_0\)</span> (derivative of <span class="math inline">\(\ell\)</span>).</li>
</ul>
<p>where <span class="math inline">\(\widehat{\boldsymbol{\theta}}_0\)</span> is the MLE with the constraints under the null, and <span class="math inline">\(\widehat{\boldsymbol{\theta}}\)</span> the MLE of the full model.</p>
</section>
<section id="visualizing-likelihood-tests" class="slide level2">
<h2>Visualizing likelihood tests</h2>

<img data-src="fig/02/likelihood_tests.png" width="400" class="r-stretch quarto-figure-center"><p class="caption">
Figure&nbsp;4: Log-likelihood curve and the three likelihood-based tests, namely Wald, likelihood ratio and score tests.
</p></section>
<section id="likelihood-based-test-statistics" class="slide level2">
<h2>Likelihood-based test statistics</h2>
<p>The three main classes of statistics for testing a simple null hypothesis <span class="math inline">\(\mathscr{H}_0: \boldsymbol{\theta}=\boldsymbol{\theta}_0\)</span> against the alternative <span class="math inline">\(\mathscr{H}_a: \boldsymbol{\theta} \neq \boldsymbol{\theta}_0\)</span> are<sup>1</sup> <span class="math display">\[\begin{align*}
W(\boldsymbol{\theta}_0) &amp;= (\widehat{\boldsymbol{\theta}}-\boldsymbol{\theta}_0)^\top j(\widehat{\boldsymbol{\theta}})(\widehat{\boldsymbol{\theta}}-\boldsymbol{\theta}_0), &amp;&amp;(\text{Wald}) \\
R(\boldsymbol{\theta}_0) &amp;= 2 \left\{ \ell(\widehat{\boldsymbol{\theta}})-\ell(\boldsymbol{\theta}_0)\right\}, &amp;&amp;(\text{likelihood ratio})\\
S(\boldsymbol{\theta}_0) &amp;= U^\top(\boldsymbol{\theta}_0)i^{-1}(\boldsymbol{\theta}_0)U(\boldsymbol{\theta}_0). &amp;&amp; (\text{score})
\end{align*}\]</span> If <span class="math inline">\(\mathscr{H}_0\)</span> is true, the three test statistics follow asymptotically a <span class="math inline">\(\chi^2_q\)</span> distribution under a null hypothesis <span class="math inline">\(\mathscr{H}_0,\)</span> where the degrees of freedom <span class="math inline">\(q\)</span> are the number of restrictions.</p>
<aside><ol class="aside-footnotes"><li id="fn3"><p>If <span class="math inline">\(q \neq p\)</span>, then we replace <span class="math inline">\(\boldsymbol{\theta}_0\)</span> by <span class="math inline">\(\widehat{\boldsymbol{\theta}}_0\)</span>, optimizing over the remaining unconstrained parameters.</p></li></ol></aside></section>
<section id="unidimensional-version-of-likelihood-statistics" class="slide level2">
<h2>Unidimensional version of likelihood statistics</h2>
<p>For scalar <span class="math inline">\(\theta\)</span> with <span class="math inline">\(q=1,\)</span> signed versions of these statistics exist, <span class="math display">\[\begin{align*}
w(\theta_0)&amp;=(\widehat{\theta}-\theta_0)/\mathsf{se}(\widehat{\theta}) &amp;&amp;(\text{wald test}) \\
r({\theta_0}) &amp;= \mathrm{sign}(\widehat{\theta}-\theta)\left[2
\left\{\ell(\widehat{\theta})-\ell(\theta)\right\}\right]^{1/2} &amp;&amp;(\text{directed likelihood root}) \\
s(\theta_0)&amp;=i^{-1/2}(\theta_0)U(\theta_0) &amp;&amp;(\text{score test})
\end{align*}\]</span></p>
<p>If the null hypothesis <span class="math inline">\(\mathscr{H}_0: \theta = \theta_0\)</span> holds true, then <span class="math inline">\(w(\theta_0)\stackrel{\cdot}{\sim} \mathsf{normal}(0,1)\)</span>, etc.</p>
</section>
<section id="comparisons-of-tests" class="slide level2">
<h2>Comparisons of tests</h2>
<p>Asymptotically, all the test statistics are equivalent (in the sense that they lead to the same conclusions about <span class="math inline">\(\mathscr{H}_0\)</span>) but they are not born equal.</p>
<ul>
<li>The likelihood ratio test statistic is normally the most powerful of the three tests (preferable).</li>
<li>The likelihood ratio test is invariant to interest-preserving reparametrizations</li>
<li>The score statistic <span class="math inline">\(S\)</span> only requires calculation of the score and information under <span class="math inline">\(\mathscr{H}_0\)</span> (because by definition <span class="math inline">\(U(\widehat{\theta})=0\)</span>), so it can be useful in problems where calculations of the maximum likelihood estimator under the alternative is costly or impossible.</li>
<li>The Wald test is easiest to derive, but it’s coverage can be dismal if the sampling distribution of <span class="math inline">\(\widehat{\boldsymbol{\theta}}\)</span> is strongly asymmetric.</li>
</ul>
</section>
<section id="likelihood-surface-and-confidence-regions" class="slide level2">
<h2>Likelihood surface and confidence regions</h2>

<img data-src="MATH60604A-slides2_files/figure-revealjs/fig-weibull-surface-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><p class="caption">
Figure&nbsp;5: Log likelihood surface for the Weibull model with 10%, 20%, , 90% likelihood ratio confidence regions (white contour curves). Higher log likelihood values are indicated by darker colors.
</p></section>
<section id="wald-test-to-compare-exponential-vs-weibull-model" class="slide level2">
<h2>Wald test to compare exponential vs Weibull model</h2>
<p>We can test whether the exponential model is an adequate simplification of the Weibull distribution by imposing the restriction <span class="math inline">\(\mathscr{H}_0: \alpha=1\)</span>. We compare the squared Wald statistics to a <span class="math inline">\(\chi^2_1\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="co"># Calculate Wald statistic</span></span>
<span id="cb7-2"><a href=""></a>wald_exp <span class="ot">&lt;-</span> (mle_weibull[<span class="dv">2</span>] <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>se_weibull[<span class="dv">2</span>]</span>
<span id="cb7-3"><a href=""></a><span class="co"># Compute p-value</span></span>
<span id="cb7-4"><a href=""></a><span class="fu">pchisq</span>(wald_exp<span class="sc">^</span><span class="dv">2</span>, <span class="at">df =</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-5"><a href=""></a><span class="do">## [1] 3.61e-10</span></span>
<span id="cb7-6"><a href=""></a><span class="co"># p-value less than 5%, reject null</span></span>
<span id="cb7-7"><a href=""></a><span class="co"># Obtain 95% confidence intervals</span></span>
<span id="cb7-8"><a href=""></a>mle_weibull[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))<span class="sc">*</span>se_weibull[<span class="dv">2</span>]</span>
<span id="cb7-9"><a href=""></a><span class="do">## [1] 2.1 3.1</span></span>
<span id="cb7-10"><a href=""></a><span class="co"># 1 is not inside the confidence interval, reject null</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We reject the null hypothesis, meaning the exponential submodel is not an adequate simplification of the Weibull <span class="math inline">\((\alpha \neq 1\)</span>).</p>
</section>
<section id="likelihood-tests-for-scalar-parameters" class="slide level2">
<h2>Likelihood tests for scalar parameters</h2>
<ul>
<li>Sometimes, we may want to perform hypothesis test or derive confidence intervals for selected components of the model if we are interested in a single component of the model (or a scalar transformation <span class="math inline">\(\phi = g(\boldsymbol{\theta})\)</span>.</li>
<li>In this case, the null hypothesis only restricts part of the space and the other parameters, termed nuisance, are left unspecified — the question then is what values to use for comparison with the full model.</li>
<li>It turns out that the values that maximize the constrained log likelihood are what one should use for the test, and the particular function in which these nuisance parameters are integrated out is termed a profile likelihood.</li>
</ul>
</section>
<section id="profile-likelihood" class="slide level2">
<h2>Profile likelihood</h2>
<p>Consider a parametric model with log likelihood function <span class="math inline">\(\ell(\boldsymbol{\theta})\)</span> whose <span class="math inline">\(p\)</span>-dimensional parameter vector <span class="math inline">\(\boldsymbol{\theta}=(\boldsymbol{\psi}, \boldsymbol{\varphi})\)</span> can be decomposed into a <span class="math inline">\(q\)</span>-dimensional parameter of interest <span class="math inline">\(\boldsymbol{\psi}\)</span> and a <span class="math inline">\((p-q)\)</span>-dimensional nuisance vector <span class="math inline">\(\boldsymbol{\varphi}.\)</span></p>
<p>We can consider the profile likelihood <span class="math inline">\(\ell_{\mathsf{p}},\)</span> a function of <span class="math inline">\(\boldsymbol{\psi}\)</span> alone, which is obtained by maximizing the likelihood pointwise at each fixed value <span class="math inline">\(\boldsymbol{\psi}_0\)</span> over the nuisance vector <span class="math inline">\(\boldsymbol{\varphi}_{\psi_0},\)</span> <span class="math display">\[\begin{align*}
\ell_{\mathsf{p}}(\boldsymbol{\psi})=\max_{\boldsymbol{\varphi}}\ell(\boldsymbol{\psi}, \boldsymbol{\varphi})=\ell(\boldsymbol{\psi}, \widehat{\boldsymbol{\varphi}}_{\boldsymbol{\psi}}).
\end{align*}\]</span></p>
</section>
<section id="profile-likelihood-for-shape-of-a-weibull-model" class="slide level2">
<h2>Profile likelihood for shape of a Weibull model</h2>
<p>Consider the shape parameter <span class="math inline">\(\psi \equiv\alpha\)</span> as parameter of interest, and the scale <span class="math inline">\(\varphi\equiv\lambda\)</span> as nuisance parameter. Using the gradient, <span class="math display">\[\begin{align*}
\frac{\partial \ell(\lambda, \alpha)}{\partial \lambda} &amp;= -\frac{n\alpha}{\lambda} +\alpha\lambda^{-\alpha-1}\sum_{i=1}^n y_i^\alpha \\
\end{align*}\]</span> we find that the value of the scale that maximizes the log likelihood for given <span class="math inline">\(\alpha\)</span> is <span class="math display">\[\begin{align*}
\widehat{\lambda}_\alpha = \left( \frac{1}{n}\sum_{i=1}^n y_i^\alpha\right)^{1/\alpha}.
\end{align*}\]</span> and plugging in this value gives a function of <span class="math inline">\(\alpha\)</span> alone, thereby also reducing the optimization problem for the Weibull to a line search along <span class="math inline">\(\ell_{\mathsf{p}}(\alpha)\)</span>.</p>
</section>
<section id="profile-for-the-shape" class="slide level2">
<h2>Profile for the shape</h2>

<img data-src="MATH60604A-slides2_files/figure-revealjs/fig-weibull-profile-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><p class="caption">
Figure&nbsp;6: Profile log likelihood for <span class="math inline">\(\alpha\)</span>, shown as a dashed gray line (left) and as a transect (right). The profile on the right hand panel has been shifted vertically to be zero at the MLE; the dashed horizontal lines denote the cutoff points for the 95% and 99% confidence intervals.
</p></section>
<section id="analogy-for-the-profile-log-likelihood" class="slide level2">
<h2>Analogy for the profile log likelihood</h2>
<ul>
<li>If one thinks of these contours lines as those of a topographic map, the profile likelihood corresponds in this case to walking along the ridge of both mountains along the <span class="math inline">\(\psi\)</span> direction, with the right panel showing the elevation gain/loss.</li>
<li>The corresponding elevation profile on the right of <a href="#/fig-weibull-profile" class="quarto-xref">Figure&nbsp;6</a> with cutoff values.</li>
<li>We would need to obtain numerically using a root finding algorithm the limits of the confidence interval on either side of <span class="math inline">\(\widehat{\alpha}\)</span>, but it’s clear that <span class="math inline">\(\alpha=1\)</span> is not inside even the 99% confidence interval.</li>
</ul>
</section>
<section id="profile-log-likelihood-for-the-weibull-expected-value" class="slide level2">
<h2>Profile log likelihood for the Weibull expected value</h2>
<ul>
<li>As an alternative, we can use numerical optimization to compute the profile for another function. Suppose we are interested in the expected waiting time, which according to the model is <span class="math inline">\(\mu = \mathsf{E}(Y) = \lambda\Gamma(1+1/\alpha)\)</span>.</li>
<li>To this effect, we reparametrize the model in terms of <span class="math inline">\((\mu, \alpha)\)</span>, where <span class="math inline">\(\lambda=\mu/\Gamma(1+1/\alpha)\)</span>.</li>
<li>We then make a wrapper function that optimizes the log likelihood for fixed value of <span class="math inline">\(\mu\)</span>, then returns <span class="math inline">\(\widehat{\alpha}_{\mu}\)</span>, <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\ell_{\mathrm{p}}(\mu)\)</span>.</li>
</ul>
<div title="**R** demo">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>R</strong> demo</strong></p>
</div>
<div class="callout-content">
<p>Create a function to compute the profile-based confidence intervals.</p>
</div>
</div>
</div>
</div>
</section>
<section id="computation-of-confidence-intervals" class="slide level2">
<h2>Computation of confidence intervals</h2>
<p>To get the confidence intervals for a scalar parameter, there is a trick that helps with the derivation.</p>
<ol type="1">
<li>Compute the directed likelihood root <span class="math display">\[r(\psi) = \mathrm{sign}(\psi - \widehat{\psi})\{2\ell_{\mathrm{p}}(\widehat{\psi}) -2 \ell_{\mathrm{p}}(\psi)\}^{1/2}\]</span> over a fine grid of <span class="math inline">\(\psi\)</span></li>
<li>Fit a smoothing spline with response <span class="math inline">\(y=\psi\)</span> and explanatory <span class="math inline">\(x=r(\psi)\)</span>.</li>
<li>Predict the curve at the standard normal quantiles <span class="math inline">\(\mathfrak{z}_{\alpha/2}\)</span> and <span class="math inline">\(\mathfrak{z}_{1-\alpha/2}\)</span></li>
<li>Return these values as confidence interval.</li>
</ol>
</section>
<section id="profile-for-the-mean-of-the-weibull" class="slide level2">
<h2>Profile for the mean of the Weibull</h2>

<img data-src="MATH60604A-slides2_files/figure-revealjs/fig-profile-mu-weibull-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><p class="caption">
Figure&nbsp;7: Signed likelihood root (left) and shifted profile log likelihood (right) as a function of the expected value <span class="math inline">\(\mu\)</span> in the Weibull model.
</p></section>
<section id="comparison-of-models" class="slide level2">
<h2>Comparison of models</h2>
<ul>
<li>The likelihood can also serve as building block for model comparison: the larger <span class="math inline">\(\ell(\boldsymbol{\widehat{\theta}})\)</span>, the better the fit.</li>
<li>However, the likelihood doesn’t account for model complexity in the sense that more complex models with more parameters lead to higher likelihood.</li>
<li>This is not a problem for comparison of nested models using the likelihood ratio test because we look only at relative improvement in fit.</li>
<li>There is a danger of <strong>overfitting</strong> if we only consider the likelihood of a model.</li>
</ul>
</section>
<section id="information-criteria" class="slide level2">
<h2>Information criteria</h2>
<p>Information criteria combine the log likelihood, measuring how well the model fits the data, with a penalty for the number of parameters. <span class="math display">\[\begin{align*}
\mathsf{AIC}&amp;=-2\ell(\widehat{\boldsymbol{\theta}})+2p \\
\mathsf{BIC}&amp;=-2\ell(\widehat{\boldsymbol{\theta}})+p\ln(n),
\end{align*}\]</span> where <span class="math inline">\(p\)</span> is the number of parameters in the model.</p>
<p>The smaller the value of Akaike’s information criterion <span class="math inline">\(\mathsf{AIC}\)</span> (or of the Bayesian information criterion <span class="math inline">\(\mathsf{BIC}\)</span>), the better the model fit.</p>
<p>Note that information criteria do not constitute formal hypothesis tests on the parameters, but they can be used to compare models that are not nested (but noisy proxy!)</p>
</section>
<section id="learning-objectives" class="slide level2">
<h2>Learning objectives</h2>
<div title="Learning objectives">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Learning objectives</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Learn the terminology associated with likelihood-based inference</li>
<li>Derive closed-form expressions for the maximum likelihood estimator in simple models</li>
<li>Using numerical optimization, obtain parameter estimates and their standards errors using maximum likelihood</li>
<li>Use large-sample properties of the likelihood to derive confidence intervals and tests</li>
<li>Use information criteria for model selection</li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>
<div class="quarto-auto-generated-content">
<p><img src="fig/logo_hec_montreal_bleu_web.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Davison:2003" class="csl-entry" role="listitem">
Davison, A. C. 2003. <em>Statistical Models</em>. Cambridge University Press.
</div>
</div>
</section>

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="MATH60604A-slides2_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="MATH60604A-slides2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="MATH60604A-slides2_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="MATH60604A-slides2_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="MATH60604A-slides2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="MATH60604A-slides2_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="MATH60604A-slides2_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="MATH60604A-slides2_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="MATH60604A-slides2_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="MATH60604A-slides2_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>