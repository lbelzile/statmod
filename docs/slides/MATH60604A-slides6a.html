<!DOCTYPE html>
<html lang="en"><head>
<script src="MATH60604A-slides6a_files/libs/clipboard/clipboard.min.js"></script>
<script src="MATH60604A-slides6a_files/libs/quarto-html/tabby.min.js"></script>
<script src="MATH60604A-slides6a_files/libs/quarto-html/popper.min.js"></script>
<script src="MATH60604A-slides6a_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="MATH60604A-slides6a_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="MATH60604A-slides6a_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="MATH60604A-slides6a_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="MATH60604A-slides6a_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.1">

  <meta name="author" content="Léo Belzile, HEC Montréal">
  <meta name="dcterms.date" content="2024-01-01">
  <title>Statistical modelling</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="MATH60604A-slides6a_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="MATH60604A-slides6a_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="MATH60604A-slides6a_files/libs/revealjs/dist/theme/quarto.css">
  <link href="MATH60604A-slides6a_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="MATH60604A-slides6a_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="MATH60604A-slides6a_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="MATH60604A-slides6a_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#002855" class="quarto-title-block center">
  <h1 class="title">Statistical modelling</h1>
  <p class="subtitle">06. Linear models</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Léo Belzile, HEC Montréal 
</div>
</div>
</div>

  <p class="date">2024</p>
</section>
<section id="model-assumptions" class="slide level2">
<h2>Model assumptions</h2>
<p>There are four main assumptions of the linear model specification <span class="math display">\[Y_i \mid \mathbf{x}_i \sim \mathsf{normal}(\mathbf{x}_i\boldsymbol{\beta}, \sigma^2).\]</span></p>
<ul>
<li>linearity and additivity: the mean of <span class="math inline">\(Y_i \mid \mathbf{x}_i\)</span> is <span class="math inline">\(\beta_0 + \beta_1x_{i1} + \cdots + \beta_p x_{ip}\)</span>.</li>
<li>homoscedasticity: the error variance <span class="math inline">\(\sigma^2\)</span> is constant</li>
<li>independence of the errors/observations conditional on covariates</li>
<li>normality</li>
</ul>
</section>
<section id="read-the-fine-prints" class="slide level2">
<h2>Read the fine prints</h2>
<p>Our strategy is to create graphical diagnostic tools or perform hypothesis tests to ensure that there is no gross violation of the model underlying assumptions.</p>
<ul>
<li>When we perform an hypothesis test, we merely fail to reject the null hypothesis, either because the latter is true or else due to lack of evidence.</li>
<li>The same goes for checking the validity of model assumptions.</li>
<li>Beware of over-interpreting diagnostic plots: the human eye is very good at finding spurious patterns…</li>
</ul>
</section>
<section id="assumption-1---mean-model-specification" class="slide level2">
<h2>Assumption 1 - mean model specification</h2>
<p>The mean is <span class="math display">\[\mathsf{E}(Y_i \mid \mathbf{x}_i)=\beta_0 + \beta_1x_{i1} + \cdots + \beta_p x_{ip}.\]</span></p>
<p>Implicitly,</p>
<ul>
<li>All interactions are included.</li>
<li>There are no omitted explanatories from the model,</li>
<li>The relationship between <span class="math inline">\(Y_i\)</span> and <span class="math inline">\(X_j\)</span> is linear.</li>
<li>The effect is additive.</li>
</ul>
</section>
<section id="diagnostic-plots-for-linearity" class="slide level2">
<h2>Diagnostic plots for linearity</h2>
<p>Use ordinary residuals <span class="math inline">\(\boldsymbol{e}\)</span>, which are uncorrelated with fitted values <span class="math inline">\(\widehat{\boldsymbol{y}}\)</span> and explanatory variables (i.e., columns of <span class="math inline">\(\mathbf{X}\)</span>).</p>
<ul>
<li>Plots of residuals <span class="math inline">\(\boldsymbol{e}\)</span> against fitted values <span class="math inline">\(\widehat{\boldsymbol{y}}\)</span></li>
<li>Plot of residuals <span class="math inline">\(\boldsymbol{e}\)</span> against columns from the model matrix, <span class="math inline">\(\mathbf{X}\)</span></li>
<li>Plot of residuals <span class="math inline">\(\boldsymbol{e}\)</span> against omitted variables</li>
</ul>
<p>Any local pattern or patterns (e.g., quadratic trend, cycles, changepoints, subgroups) are indicative of misspecification of the mean model.</p>
<p>Use local smoother (GAM or LOESS) to detect trends.</p>
</section>
<section id="examples-of-residual-plots" class="slide level2">
<h2>Examples of residual plots</h2>
<p>Look for pattern in the <span class="math inline">\(y\)</span>-axis, not the <span class="math inline">\(x\)</span>-axis!</p>

<img data-src="MATH60604A-slides6a_files/figure-revealjs/fig-regdiaglin-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">
Figure&nbsp;1: Scatterplots of residuals against fitted values. The first two plots show no departure from linearity (mean zero). The third plot shows a clear quadratic pattern, suggesting the mean model is misspecified. Note that the distribution of the fitted value need not be uniform, as in the second panel which shows more high fitted values.
</p></section>
<section id="examples" class="slide level2">
<h2>Examples</h2>

<img data-src="MATH60604A-slides6a_files/figure-revealjs/fig-residplots-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">
Figure&nbsp;2: Scatterplot of residuals against explanatory (left) and an omitted covariate (right). We can pick up a forgotten interaction between BMI and smoker/obese and a linear trend for the number of children.
</p></section>
<section id="examples-for-the-college-data" class="slide level2">
<h2>Examples for the college data</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="fu">data</span>(college, <span class="at">package =</span> <span class="st">"hecstatmod"</span>)</span>
<span id="cb1-2"><a href=""></a>linmod.college1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> rank <span class="sc">+</span> field <span class="sc">+</span> sex <span class="sc">+</span> service <span class="sc">+</span> years, <span class="at">data =</span> college)</span>
<span id="cb1-3"><a href=""></a>car<span class="sc">::</span><span class="fu">residualPlots</span>(linmod.college1, <span class="at">test =</span> <span class="cn">FALSE</span>, <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="MATH60604A-slides6a_files/figure-revealjs/unnamed-chunk-4-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"></section>
<section id="remedy-for-mean-model-specification" class="slide level2">
<h2>Remedy for mean model specification</h2>
<p>Fix the mean model</p>
<ul>
<li>Add covariates that are important explanatories</li>
<li>Include interactions if necessary</li>
<li>For residual patterns, specify the effect of nonlinear terms via penalized splines</li>
<li>Transformations</li>
</ul>
</section>
<section id="assumption-2-homoscedasticity-equal-variance" class="slide level2">
<h2>Assumption 2: homoscedasticity (equal variance)</h2>
<p>The variance is the same for all observations, <span class="math inline">\(\mathsf{Va}(Y_i \mid \mathbf{x}_i) = \sigma^2\)</span></p>
<p>Typical heteroscedasticity patterns arise when</p>
<ul>
<li>Variance varies per levels of a categorical variable</li>
<li>Variance increases with the response (typically multiplicative models)</li>
<li>Data are drawn from a distribution whose variance depends on the mean, e.g., Poisson</li>
</ul>
</section>
<section id="diagnostic-for-equal-variance" class="slide level2">
<h2>Diagnostic for equal variance</h2>
<p>Use externally studentized residuals <span class="math inline">\(r_i\)</span>, which have equal variance.</p>
<p>Hypothesis tests:</p>
<ul>
<li>Levene test (fit ANOVA to <span class="math inline">\(|r_{ij} - \overline{r_{j}}|\)</span> as a function of group index <span class="math inline">\(j \in \{1, \ldots, J\}\)</span>)</li>
<li>Breusch–Pagan test (popular in economics, fits linear regression to <span class="math inline">\(e_i^2\)</span>)</li>
<li>Bartlett test (normal likelihood ratio test for different variance, but very sensitive to normality assumption so not recommended)</li>
</ul>
<p>Graphical diagnostics</p>
<ul>
<li>Plot (absolute value of) <span class="math inline">\(r_i\)</span> against fitted values (spread-level plot)</li>
</ul>
</section>
<section id="examples-of-spread-level-plots" class="slide level2">
<h2>Examples of spread level plots</h2>

<img data-src="MATH60604A-slides6a_files/figure-revealjs/fig-diagfitvalhomosce-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">
Figure&nbsp;3: Plot of externally studentized residuals against fitted value (left) and categorical explanatory (right). Both clearly display heteroscedasticity.
</p></section>
<section id="heteroscedasticity-tests-for-college-data" class="slide level2">
<h2>Heteroscedasticity tests for college data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="co"># Extract externally studentized residuals</span></span>
<span id="cb2-2"><a href=""></a>r <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(linmod.college1)</span>
<span id="cb2-3"><a href=""></a><span class="co"># Levene test (F-test for ANOVA)</span></span>
<span id="cb2-4"><a href=""></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(r <span class="sc">~</span> rank, <span class="at">center =</span> <span class="st">"mean"</span>, <span class="at">data =</span> college)</span>
<span id="cb2-5"><a href=""></a><span class="do">## Levene's Test for Homogeneity of Variance (center = "mean")</span></span>
<span id="cb2-6"><a href=""></a><span class="do">##        Df F value Pr(&gt;F)    </span></span>
<span id="cb2-7"><a href=""></a><span class="do">## group   2      50 &lt;2e-16 ***</span></span>
<span id="cb2-8"><a href=""></a><span class="do">##       394                   </span></span>
<span id="cb2-9"><a href=""></a><span class="do">## ---</span></span>
<span id="cb2-10"><a href=""></a><span class="do">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb2-11"><a href=""></a><span class="co"># Breusch-Pagan (with a score test)</span></span>
<span id="cb2-12"><a href=""></a>car<span class="sc">::</span><span class="fu">ncvTest</span>(linmod.college1, <span class="at">var.formula =</span>  <span class="sc">~</span> rank)</span>
<span id="cb2-13"><a href=""></a><span class="do">## Non-constant Variance Score Test </span></span>
<span id="cb2-14"><a href=""></a><span class="do">## Variance formula: ~ rank </span></span>
<span id="cb2-15"><a href=""></a><span class="do">## Chisquare = 70, Df = 2, p = 6e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="consequences-of-unequal-variance" class="slide level2">
<h2>Consequences of unequal variance</h2>

<img data-src="MATH60604A-slides6a_files/figure-revealjs/fig-simuWelchnull-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">
Figure&nbsp;4: Histogram of the null distribution of <span class="math inline">\(p\)</span>-values obtained through simulation using the two-sample <span class="math inline">\(t\)</span>-test (left) and Welch’s <span class="math inline">\(t\)</span>-test (right), based on 10 000 simulations. Each simulated sample consist of 50 observations from a <span class="math inline">\(\mathsf{normal}(0, 1)\)</span> distribution and 10 observations from <span class="math inline">\(\mathsf{normal}(0, 9)\)</span>. The uniform distribution would have 5% in each of the 20 bins used for the display.
</p></section>
<section id="remedy-1---specify-the-variance-structure" class="slide level2">
<h2>Remedy 1 - specify the variance structure</h2>
<p>Specify a function for the variance, e.g.,</p>
<ul>
<li><span class="math inline">\(\sigma_j\)</span> for level <span class="math inline">\(j\)</span> of a categorical variable,</li>
<li><span class="math inline">\(\sigma^2(\boldsymbol{v}_i) = g(\boldsymbol{v}_i; \boldsymbol{\theta})\)</span> for some suitable transformation <span class="math inline">\(g(\cdot): \mathbb{R} \to (0, \infty)\)</span>, some covariate vector <span class="math inline">\(\boldsymbol{v}\)</span> and parameter <span class="math inline">\(\boldsymbol{\theta}\)</span>.</li>
</ul>
<p>A model specification enables the use of likelihood ratio tests.</p>
<p>The model can be fitted via restricted maximum likelihood using the function <code>gls</code> from package <code>nlme</code>.</p>
</section>
<section id="example-of-heteroscedasticity-for-the-college-data" class="slide level2">
<h2>Example of heteroscedasticity for the college data</h2>
<p>For the college data, we set <span class="math inline">\(Y_i \sim \mathsf{normal}(\mathbf{x}_i\boldsymbol{\beta}, \sigma^2_{\texttt{rank}_i})\)</span> with three different variance parameters. This seemingly corrects the heteroscedasticity.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="fu">library</span>(nlme) <span class="co"># R package for mixed models and variance specification</span></span>
<span id="cb3-2"><a href=""></a>linmod.college2 <span class="ot">&lt;-</span> nlme<span class="sc">::</span><span class="fu">gls</span>(</span>
<span id="cb3-3"><a href=""></a>  <span class="at">model =</span> salary <span class="sc">~</span> rank <span class="sc">+</span> field <span class="sc">+</span> sex <span class="sc">+</span> service, <span class="co"># mean specification</span></span>
<span id="cb3-4"><a href=""></a>  <span class="at">weights =</span> nlme<span class="sc">::</span><span class="fu">varIdent</span>(<span class="at">form =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> rank), <span class="co"># constant variance per rank</span></span>
<span id="cb3-5"><a href=""></a>  <span class="at">data =</span> college)</span>
<span id="cb3-6"><a href=""></a><span class="fu">plot</span>(linmod.college2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="MATH60604A-slides6a_files/figure-revealjs/unnamed-chunk-8-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="group-heteroscedasticity-in-anova" class="slide level2">
<h2>Group heteroscedasticity in ANOVA</h2>
<p>The <code>t.test</code> and <code>oneway.test</code> functions in <strong>R</strong> perform hypothesis test for equality of mean: for observation <span class="math inline">\(i\)</span> from group <span class="math inline">\(j\)</span>, the model specified is</p>
<p><span class="math display">\[Y_{ij} \sim \mathsf{normal}(\mu_j, \sigma^2_j).\]</span> These tests are often labelled by software under the name of <span class="citation" data-cites="Welch:1947">Welch (<a href="#/references" role="doc-biblioref" onclick="">1947</a>)</span>.</p>
<p>There is no exact expression for the null distribution for equal variance, but approximations due to <span class="citation" data-cites="Satterthwaite:1946">Satterthwaite (<a href="#/references" role="doc-biblioref" onclick="">1946</a>)</span> are used as benchmarks.</p>
<p>We need enough people in each subgroup to reliably estimate both the mean and variance!</p>
</section>
<section id="remedy-2---use-a-sandwich-matrix-for-the-errors" class="slide level2">
<h2>Remedy 2 - use a sandwich matrix for the errors</h2>
<p>Economists often use <strong>sandwich</strong> estimators <span class="citation" data-cites="White:1980">(<a href="#/references" role="doc-biblioref" onclick="">White 1980</a>)</span>, whereby we replace the estimator of the covariance matrix of <span class="math inline">\(\widehat{\boldsymbol{\beta}}\)</span>, usually <span class="math inline">\(S^2(\mathbf{X}^\top\mathbf{X})^{-1}\)</span>, by a sandwich estimator of the form</p>
<p><span class="math display">\[\widehat{\mathsf{Va}}_{\mathsf{HCE}}(\boldsymbol{\widehat{\beta}}) = (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top\boldsymbol{\Omega}\mathbf{X}(\mathbf{X}^\top\mathbf{X})^{-1}\]</span> with <span class="math inline">\(\boldsymbol{\Omega}\)</span> a diagonal matrix.</p>
<p>Popular choices are heteroscedastic consistent matrices <span class="citation" data-cites="McKinnon.White:1985">(<a href="#/references" role="doc-biblioref" onclick="">MacKinnon and White 1985</a>)</span>, e.g., taking <span class="math inline">\(\mathrm{diag}(\boldsymbol{\Omega})_i = e_i^2/(1-h_{ii})^2\)</span>, the so-called HC<span class="math inline">\({}_3\)</span>.</p>
</section>
<section id="example-of-sandwich-matrix" class="slide level2">
<h2>Example of sandwich matrix</h2>
<p>Replace <span class="math inline">\(\mathsf{Va}(\widehat{\boldsymbol{\beta}})\)</span> by <span class="math inline">\(\widehat{\mathsf{Va}}_{\mathsf{HCE}}(\boldsymbol{\widehat{\beta}})\)</span> in the formula of Wald tests.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a>vcov_HCE <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">hccm</span>(linmod.college1)</span>
<span id="cb4-2"><a href=""></a><span class="co"># Wald tests with sandwich matrix</span></span>
<span id="cb4-3"><a href=""></a>w <span class="ot">&lt;-</span> <span class="fu">coef</span>(linmod.college1) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(vcov_HCE))</span>
<span id="cb4-4"><a href=""></a><span class="co"># Variance ratios</span></span>
<span id="cb4-5"><a href=""></a><span class="fu">diag</span>(vcov_HCE) <span class="sc">/</span> <span class="fu">diag</span>(<span class="fu">vcov</span>(linmod.college1))</span>
<span id="cb4-6"><a href=""></a><span class="do">##      (Intercept)    rankassociate         rankfull fieldtheoretical </span></span>
<span id="cb4-7"><a href=""></a><span class="do">##             0.27             0.29             0.62             0.99 </span></span>
<span id="cb4-8"><a href=""></a><span class="do">##         sexwoman          service            years </span></span>
<span id="cb4-9"><a href=""></a><span class="do">##             0.41             2.19             1.76</span></span>
<span id="cb4-10"><a href=""></a><span class="co"># Compute p-values</span></span>
<span id="cb4-11"><a href=""></a>pval <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="fu">abs</span>(w), </span>
<span id="cb4-12"><a href=""></a>             <span class="at">df =</span> linmod.college1<span class="sc">$</span>df.residual,</span>
<span id="cb4-13"><a href=""></a>             <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="multiplicative-structure" class="slide level2">
<h2>Multiplicative structure</h2>
<p>Multiplicative data of the form <span class="math display">\[\begin{align*}
\left(\begin{matrix} \text{moyenne $\mu$}\end{matrix}\right) \times
\left(\begin{matrix} \text{random error}
\end{matrix}\right)
\end{align*}\]</span> tend to have higher variability when the response is larger.</p>
</section>
<section id="remedy-3---variance-stabilizing-transformations" class="slide level2">
<h2>Remedy 3 - Variance-stabilizing transformations</h2>
<p>A log-transformation of the response, <span class="math inline">\(\ln Y\)</span>, makes the model <strong>additive</strong>, assuming <span class="math inline">\(Y &gt; 0\)</span>.</p>
<p>Write the log-linear model <span class="math display">\[\begin{align*}
\ln Y = \beta_0+ \beta_0 +\beta_1 X_1 +\cdots + \beta_pX_p + \varepsilon
\end{align*}\]</span> in the original response scale as <span class="math display">\[\begin{align*}
Y &amp;= \exp\left(\beta_0 +\beta_1 X_1 +\cdots + \beta_pX_p\right)\cdot \exp(\varepsilon),
\end{align*}\]</span> and thus <span class="math display">\[\begin{align*}
\mathsf{E}(Y \mid \mathbf{X}) = \exp(\beta_0 +\beta_1 X_1 +\cdots + \beta_pX_p) \times \mathsf{E}\{\exp(\varepsilon) \mid \mathbf{X}\}.
\end{align*}\]</span></p>
</section>
<section id="lognormal-model" class="slide level2">
<h2>Lognormal model</h2>
<p>If <span class="math inline">\(\varepsilon \mid \mathbf{x} \sim \mathsf{normal}(\mu,\sigma^2)\)</span>, then <span class="math inline">\(\mathsf{E}\{\exp(\varepsilon) \mid \mathbf{x}\}= \exp(\mu+\sigma^2/2)\)</span> and <span class="math inline">\(\exp(\varepsilon)\)</span> follows a log-normal distribution.</p>
<p>An increase of one unit of <span class="math inline">\(X_j\)</span> leads to a <span class="math inline">\(\beta_j\)</span> increase of <span class="math inline">\(\ln Y\)</span> without interaction or nonlinear term for <span class="math inline">\(X_j\)</span>, and this translates into a multiplicative increase of a factor <span class="math inline">\(\exp(\beta_j)\)</span> on the original data scale for <span class="math inline">\(Y\)</span>.</p>
<ul>
<li>If <span class="math inline">\(\beta_j=0\)</span>, <span class="math inline">\(\exp(\beta_j)=1\)</span> and there is no change</li>
<li>If <span class="math inline">\(\beta_j &lt; 0\)</span>, <span class="math inline">\(\exp(\beta_j)&lt;1\)</span> and the mean decreases with <span class="math inline">\(X_j\)</span></li>
<li>If <span class="math inline">\(\beta_j &gt; 0\)</span>, <span class="math inline">\(\exp(\beta_j)&gt;1\)</span> and the mean increases with <span class="math inline">\(X_j\)</span></li>
</ul>
</section>
<section id="interpretation-of-log-linear-models" class="slide level2">
<h2>Interpretation of log linear models</h2>
<p>Compare the ratio of <span class="math inline">\(\mathsf{E}(Y \mid X_1=x+1)\)</span> to <span class="math inline">\(\mathsf{E}(Y \mid X_1=x)\)</span>, <span class="math display">\[\begin{align*}
\frac{\mathsf{E}(Y \mid X_1=x+1, X_2, \ldots, X_p)}{\mathsf{E}(Y \mid X_1=x,  X_2, \ldots, X_p)} = \frac{\exp\{\beta_1(x+1)\}}{\exp(\beta_1 x)} = \exp(\beta_1).
\end{align*}\]</span> Thus, <span class="math inline">\(\exp(\beta_1)\)</span> represents the ratio of the mean of <span class="math inline">\(Y\)</span> when <span class="math inline">\(X_1=x+1\)</span> in comparison to that when <span class="math inline">\(X_1=x\)</span>, <em>ceteris paribus</em> (and provided this statement is meaningful).</p>
<p>The percentage change is</p>
<ul>
<li><span class="math inline">\(1-\exp(\beta_j)\)</span> if <span class="math inline">\(\beta_j &lt;0\)</span> and</li>
<li><span class="math inline">\(\exp(\beta_j)-1\)</span> if <span class="math inline">\(\beta_j&gt;0\)</span>.</li>
</ul>
</section>
<section id="more-general-transformations" class="slide level2">
<h2>More general transformations</h2>
<p>Consider the case where both <span class="math inline">\(Y\)</span> and <span class="math inline">\(X_1\)</span> is log-transformed, so that <span class="math display">\[\begin{align*}
Y= X_1^{\beta_1}\exp(\beta_0 + \beta_2X_2 + \cdots + \beta_pX_p + \varepsilon)
\end{align*}\]</span> Taking the derivative of the left hand side with respect to <span class="math inline">\(X_1&gt;0\)</span>, we get <span class="math display">\[\begin{align*}
\frac{\partial Y}{\partial X_1}&amp;= \beta_1 X_1^{\beta_1-1}\exp(\beta_0 + \beta_2X_2 + \cdots + \beta_pX_p + \varepsilon)= \frac{\beta_1 Y}{X_1}
\end{align*}\]</span> and thus we can rearrange the expression so that <span class="math display">\[\begin{align*}
\frac{\partial X_1}{X_1}\beta_1 = \frac{\partial Y}{Y};
\end{align*}\]</span> this is a partial <strong>elasticity</strong>, so <span class="math inline">\(\beta_1\)</span> is interpreted as a <span class="math inline">\(\beta_1\)</span> percentage change in <span class="math inline">\(Y\)</span> for each percentage increase of <span class="math inline">\(X_1\)</span>, <em>ceteris paribus</em>.</p>
</section>
<section id="independence-assumption" class="slide level2">
<h2>Independence assumption</h2>
<p>Follows from sampling scheme (<em>random sample</em>), need context to infer whether this assumption holds.</p>
<p>Typical violations include</p>
<ul>
<li>repeated measures (correlated observations).</li>
<li>longitudinal data: repeated measurements are taken from the same subjects (few time points)</li>
<li>time series: observations observed at multiple time periods</li>
<li>spatial data</li>
</ul>
</section>
<section id="consequences-of-dependence" class="slide level2">
<h2>Consequences of dependence</h2>
<p>Nearby things are more alike, so the amount of ‘new information’ is smaller than the sample size.</p>
<p>When observations are positively correlated, the estimated standard errors reported by the software are too small.</p>
<p>This means we are overconfident and will reject the null hypothesis more often then we should if the null is true (inflated Type I error, or false positive).</p>
</section>
<section id="consequences-of-correlated-data" class="slide level2">
<h2>Consequences of correlated data</h2>

<img data-src="MATH60604A-slides6a_files/figure-revealjs/fig-plotLevelIndep-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">
Figure&nbsp;5: Percentage of rejection of the null hypothesis for the <span class="math inline">\(F\)</span>-test of equality of means for the one way ANOVA with data generated with equal mean and variance from an equicorrelation model (within group observations are correlated, between group observations are independent). The nominal level of the test is 5%.
</p></section>
<section id="fixes-for-group-structure-and-autocorrelation" class="slide level2">
<h2>Fixes for group structure and autocorrelation</h2>
<p>Chapter 6 will deal with <strong>correlated data</strong></p>
<p>The main idea is to assume instead that <span class="math display">\[\boldsymbol{Y} \mid \mathbf{X} \sim \mathsf{normal}_n(\mathbf{X}\boldsymbol{\beta}, \boldsymbol{\Sigma})\]</span> and model explicitly the <span class="math inline">\(n \times n\)</span> variance matrix <span class="math inline">\(\boldsymbol{\Sigma}\)</span>, parametrized in terms of covariance parameters <span class="math inline">\(\boldsymbol{\psi}\)</span>.</p>
</section>
<section id="time-series-and-longitudinal-data" class="slide level2">
<h2>Time series and longitudinal data</h2>
<p>For time series, we can look instead at a correlogram, i.e., a bar plot of the correlation between two observations <span class="math inline">\(h\)</span> units apart as a function of the lag <span class="math inline">\(h\)</span>.</p>
<p>For <span class="math inline">\(y_1, \ldots, y_n\)</span> and constant time lags <span class="math inline">\(h=0, 1, \ldots\)</span> units, the autocorrelation at lag <span class="math inline">\(h\)</span> is <span class="citation" data-cites="Brockwell.Davis:2016">(<a href="#/references" role="doc-biblioref" onclick="">Brockwell and Davis 2016</a>, Definition 1.4.4)</span> <span class="math display">\[\begin{align*}
r(h) = \frac{\gamma(h)}{\gamma(0)}, \qquad \gamma(h) = \frac{1}{n}\sum_{i=1}^{n-|h|} (y_i-\overline{y})(y_{i+h} - \overline{y})
\end{align*}\]</span></p>
</section>
<section id="example-of-correlogram" class="slide level2">
<h2>Example of correlogram</h2>

<img data-src="MATH60604A-slides6a_files/figure-revealjs/fig-correlogram-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">
Figure&nbsp;6: Correlogram of independent observations (left) and the ordinary residuals of the log-linear model fitted to the air passengers data (right). While the mean model of the latter is seemingly correctly specified, there is residual dependence between monthly observations and yearly (at lag 12). The blue lines give approximate pointwise 95% confidence intervals for white noise (uncorrelated observations).
</p></section>
<section id="normality-assumption" class="slide level2">
<h2>Normality assumption</h2>
<p>Without doubt the least important assumption.</p>
<p>Ordinary least squares are <strong>best linear unbiased estimators</strong> (BLUE) if the data are independent and the variance is constant, regardless of normality.</p>
<p>They are still unbiased and consistent if the variance is misspecified.</p>
<p>Tests for <strong>parameters</strong> are valid provided that each coefficient estimator is based on a <strong>sufficient number of observations</strong>.</p>
<ul>
<li>watch out for interactions with categorical variables (small subgroups).</li>
</ul>
</section>
<section id="quantile-quantile-plots" class="slide level2">
<h2>Quantile-quantile plots</h2>
<p>Produce Student quantile-quantile plots of externally studentized residuals <span class="math inline">\(R_i \sim \mathsf{Student}(n-p-2)\)</span>.</p>

<img data-src="MATH60604A-slides6a_files/figure-revealjs/fig-qqplotresid-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">
Figure&nbsp;7: Histogram (left) and Student quantile-quantile plot (right) of the externally studentized residuals. The left panel includes a kernel density estimate (black), with the density of Student distribution (blue) superimposed. The right panel includes pointwise 95% confidence bands calculated using a bootstrap.
</p></section>
<section id="interpretation-of-quantile-quantile-plots" class="slide level2">
<h2>Interpretation of quantile-quantile plots</h2>

<img data-src="MATH60604A-slides6a_files/figure-revealjs/fig-qqplotsbad-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">
Figure&nbsp;8: Quantile-quantile plots of non-normal data, showing typical look of behaviour of discrete (top left), heavy tailed (top right), skewed (bottom left) and bimodal data (bottom right).
</p></section>
<section id="remedy-for-normality" class="slide level2">
<h2>Remedy for normality</h2>
<ul>
<li>If data arise from different families (Poisson or negative binomial counts, binomial data for proportions and binary, etc.), use <strong>generalized linear models</strong>.</li>
<li>Box–Cox type transformations</li>
</ul>
</section>
<section id="boxcox-transformation" class="slide level2">
<h2>Box–Cox transformation</h2>
<p>For strictly positive data, one can consider a Box–Cox transformation, <span class="math display">\[\begin{align*}
y(\lambda)= \begin{cases}
(y^{\lambda}-1)/\lambda, &amp; \lambda \neq 0\\
\ln(y), &amp; \lambda=0.
\end{cases}
\end{align*}\]</span> The cases</p>
<ul>
<li><span class="math inline">\(\lambda=-1\)</span> (inverse),</li>
<li><span class="math inline">\(\lambda=1\)</span> (identity) and</li>
<li><span class="math inline">\(\lambda=0\)</span> (log-linear model)</li>
</ul>
<p>are perhaps the most important because they yield interpretable models.</p>
</section>
<section id="inference-for-boxcox-models" class="slide level2">
<h2>Inference for Box–Cox models</h2>
<p>If we assume that <span class="math inline">\(\boldsymbol{Y}(\lambda) \sim \mathsf{normal}(\mathbf{X}\boldsymbol{\beta}, \sigma^2 \mathbf{I}_n)\)</span>, then the likelihood is <span class="math display">\[\begin{align*}
L(\lambda, \boldsymbol{\beta}, \sigma; \boldsymbol{y}, \mathbf{X}) &amp;= (2\pi\sigma^2)^{-n/2} J(\lambda, \boldsymbol{y}) \times\\&amp; \quad \exp \left[ - \frac{1}{2\sigma^2}\{\boldsymbol{y}(\lambda) - \mathbf{X}\boldsymbol{\beta}\}^\top\{\boldsymbol{y}(\lambda) - \mathbf{X}\boldsymbol{\beta}\}\right],
\end{align*}\]</span> where <span class="math inline">\(J\)</span> denotes the Jacobian of the Box–Cox transformation, <span class="math inline">\(J(\lambda, \boldsymbol{y})=\prod_{i=1}^n y_i^{\lambda-1}\)</span>.</p>
</section>
<section id="profiling-lambda" class="slide level2">
<h2>Profiling <span class="math inline">\(\lambda\)</span></h2>
<p>For each given value of <span class="math inline">\(\lambda\)</span>, the maximum likelihood estimator is that of the usual regression model, with <span class="math inline">\(\boldsymbol{y}\)</span> replaced by <span class="math inline">\(\boldsymbol{y}(\lambda)\)</span>.</p>
<p>The profile log likelihood for <span class="math inline">\(\lambda\)</span> is <span class="math display">\[\begin{align*}
\ell_{\mathsf{p}}(\lambda) = -\frac{n}{2}\ln(2\pi \widehat{\sigma}^2_\lambda) - \frac{n}{2} + (\lambda - 1)\sum_{i=1}^n \ln(y_i)
\end{align*}\]</span></p>
</section>
<section id="boxcox-transform-for-the-poison-data" class="slide level2">
<h2>Box–Cox transform for the poison data</h2>
<p><span class="citation" data-cites="Box.Cox:1964">Box and Cox (<a href="#/references" role="doc-biblioref" onclick="">1964</a>)</span> considered survival time for 48 animals based on a randomized trial. The <code>poisons</code> data are balanced, with 3 poisons were administered with 4 treatments to four animals each.</p>
<p>We could consider a two-way ANOVA without interaction, given the few observations for each combination. The model would be of the form <span class="math display">\[\begin{align*}
Y &amp;= \beta_0 + \beta_1 \texttt{poison}_2 + \beta_2\texttt{poison}_3  +\beta_3\texttt{treatment}_2 \\ &amp;\qquad+ \beta_4\texttt{treatment}_3
+\beta_5\texttt{treatment}_4 + \varepsilon
\end{align*}\]</span></p>
</section>
<section id="diagnostic-plots-for-poison-data" class="slide level2">
<h2>Diagnostic plots for poison data</h2>

<img data-src="MATH60604A-slides6a_files/figure-revealjs/fig-poisonplots-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><p class="caption">
Figure&nbsp;9: Diagnostic plots for the poison data: ordinary residuals (jittered) for the linear model for survival time as a function of poison and treatment and fitted values against residuals.
</p></section>
<section id="profile-plot" class="slide level2">
<h2>Profile plot</h2>

<img data-src="MATH60604A-slides6a_files/figure-revealjs/unnamed-chunk-15-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><p>The profile log likelihood for the Box–Cox transform parameter, suggests a value of <span class="math inline">\(\lambda=-1\)</span> would be within the 95% confidence interval.</p>
</section>
<section id="model-with-transformation" class="slide level2">
<h2>Model with transformation</h2>
<p>The reciprocal response <span class="math inline">\(Y^{-1}\)</span> corresponds to the speed of action of the poison depending on both poison type and treatment.</p>

<img data-src="MATH60604A-slides6a_files/figure-revealjs/unnamed-chunk-16-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><p>The diagnostics plot for this model show no residual structure.</p>
</section>
<section id="comment-about-transformations" class="slide level2">
<h2>Comment about transformations</h2>
<p>We cannot compare models fitted to <span class="math inline">\(Y_i\)</span> versus <span class="math inline">\(\ln Y_i\)</span> using, e.g., information criteria or test, because models have different responses.</p>
<p>We can use however the Box–Cox likelihood, which includes the <strong>Jacobian</strong> of the transformation, to assess the goodness of fit and compare the model with <span class="math inline">\(\lambda=0\)</span> versus <span class="math inline">\(\lambda=-1\)</span>.</p>
</section>
<section id="diagnostics-for-outliers" class="slide level2">
<h2>Diagnostics for outliers</h2>
<p>Outliers can impact the fit, the more so if they have high leverage.</p>
<p>Plot the Cook distance <span class="math inline">\(C_i\)</span> as a function of the leverage <span class="math inline">\(h_{ii}\)</span>, where <span class="math display">\[\begin{align*}
C_i=\frac{r_i^2h_{ii}}{(p+1)(1-h_{ii})}.
\end{align*}\]</span></p>
</section>
<section id="diagnostic-plots-for-the-insurance-data" class="slide level2">
<h2>Diagnostic plots for the insurance data</h2>

<img data-src="MATH60604A-slides6a_files/figure-revealjs/fig-cook-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">
Figure&nbsp;10: Diagnostic plots for outliers.
</p></section>
<section id="remedies-for-outliers" class="slide level2">
<h2>Remedies for outliers</h2>
<ul>
<li>Remove them (not recommended)</li>
<li>Use robust regression, which automatically downweights observations</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a>rmod_ins <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">rlm</span>(<span class="at">data =</span> insurance,</span>
<span id="cb5-2"><a href=""></a>  charges <span class="sc">~</span> splines<span class="sc">::</span><span class="fu">bs</span>(age) <span class="sc">+</span> obesity<span class="sc">*</span>smoker<span class="sc">*</span>bmi <span class="sc">+</span> children)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Robust regression is less efficient (higher std. errors), but more robust to outliers.</p>
<p>The theory of robust statistics beyond the scope of the course.</p>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>
<div class="quarto-auto-generated-content">
<p><img src="fig/logo_hec_montreal_bleu_web.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Box.Cox:1964" class="csl-entry" role="listitem">
Box, G. E. P., and D. R. Cox. 1964. <span>“An Analysis of Transformations.”</span> <em>Journal of the Royal Statistical Society: Series B (Methodological)</em> 26 (2): 211–43. <a href="https://doi.org/10.1111/j.2517-6161.1964.tb00553.x">https://doi.org/10.1111/j.2517-6161.1964.tb00553.x</a>.
</div>
<div id="ref-Brockwell.Davis:2016" class="csl-entry" role="listitem">
Brockwell, P. J., and R. A. Davis. 2016. <em>Introduction to Time Series and Forecasting</em>. Springer Texts in Statistics. Springer.
</div>
<div id="ref-McKinnon.White:1985" class="csl-entry" role="listitem">
MacKinnon, James G, and Halbert White. 1985. <span>“Some Heteroskedasticity-Consistent Covariance Matrix Estimators with Improved Finite Sample Properties.”</span> <em>Journal of Econometrics</em> 29 (3): 305–25. <a href="https://doi.org/10.1016/0304-4076(85)90158-7">https://doi.org/10.1016/0304-4076(85)90158-7</a>.
</div>
<div id="ref-Satterthwaite:1946" class="csl-entry" role="listitem">
Satterthwaite, F. E. 1946. <span>“An Approximate Distribution of Estimates of Variance Components.”</span> <em>Biometrics Bulletin</em> 2 (6): 110–14. <a href="http://www.jstor.org/stable/3002019">http://www.jstor.org/stable/3002019</a>.
</div>
<div id="ref-Welch:1947" class="csl-entry" role="listitem">
Welch, B. L. 1947. <span>“The Generalization of <span>‘Student’s’</span> Problem When Several Population Variances Are Involved.”</span> <em>Biometrika</em> 34 (1–2): 28–35. <a href="https://doi.org/10.1093/biomet/34.1-2.28">https://doi.org/10.1093/biomet/34.1-2.28</a>.
</div>
<div id="ref-White:1980" class="csl-entry" role="listitem">
White, Halbert. 1980. <span>“A Heteroskedasticity-Consistent Covariance Matrix Estimator and a Direct Test for Heteroskedasticity.”</span> <em>Econometrica</em> 48 (4): 817–38. <a href="https://doi.org/10.2307/1912934">https://doi.org/10.2307/1912934</a>.
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="MATH60604A-slides6a_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="MATH60604A-slides6a_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="MATH60604A-slides6a_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="MATH60604A-slides6a_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="MATH60604A-slides6a_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="MATH60604A-slides6a_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="MATH60604A-slides6a_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="MATH60604A-slides6a_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="MATH60604A-slides6a_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="MATH60604A-slides6a_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>